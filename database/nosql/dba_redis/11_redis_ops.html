<!DOCTYPE html>
<html lang="en">
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8">
  <title>Redis 运维实践 | BoobooWei</title>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Canonical links -->
  <link rel="canonical" href="http://www.toberoot.com/database/nosql/dba_redis/11_redis_ops">
  <!-- Alternate links -->
  
    
      
    
    <link rel="alternate" hreflang="x-default" href="http://www.toberoot.com/database/nosql/dba_redis/11_redis_ops" />
  
  <!-- Icon -->
  <link rel="apple-touch-icon" sizes="57x57" href="../../../icon/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="114x114" href="../../../icon/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="72x72" href="../../../icon/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="144x144" href="../../../icon/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="60x60" href="../../../icon/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="120x120" href="../../../icon/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="76x76" href="../../../icon/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="152x152" href="../../../icon/apple-touch-icon-152x152.png">
  <link rel="icon" type="image/png" href="../../../icon/favicon-196x196.png" sizes="196x196">
  <link rel="icon" type="image/png" href="../../../icon/favicon-160x160.png" sizes="160x160">
  <link rel="icon" type="image/png" href="../../../icon/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="../../../icon/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="../../../icon/favicon-32x32.png" sizes="32x32">
  <meta name="msapplication-TileColor" content="#2f83cd">
  <meta name="msapplication-TileImage" content="../../../icon/mstile-144x144.png">
  <!-- CSS -->
  <!-- build:css build/css/navy.css -->
  
<link rel="stylesheet" href="../../../css/navy.css">

  <!-- endbuild -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-lato@0.0.75/index.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.3.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css">
  <!-- RSS -->
  <link rel="alternate" href="../../../atom.xml" title="BoobooWei" type="application/atom+xml">
  <!-- Open Graph -->
  <meta name="description" content="Redis 内存使用率偏高问题原因内存使用率居高不下很多情况下都是大Key导致的。 大Key一般情况下认为：String类型的Value大于10240的是大Key，List长度大于10240认为是大Key，Hash Field的数目大于10240认为是大Key。 Redis中的数据结构对服务的性能有着举足轻重的影响，如果大key较多，容易形成性能瓶颈，甚至降低业务稳定性。 定期分析内存并根据分析结">
<meta property="og:type" content="website">
<meta property="og:title" content="Redis 运维实践">
<meta property="og:url" content="http://www.toberoot.com/database/nosql/dba_redis/11_redis_ops">
<meta property="og:site_name" content="BoobooWei">
<meta property="og:description" content="Redis 内存使用率偏高问题原因内存使用率居高不下很多情况下都是大Key导致的。 大Key一般情况下认为：String类型的Value大于10240的是大Key，List长度大于10240认为是大Key，Hash Field的数目大于10240认为是大Key。 Redis中的数据结构对服务的性能有着举足轻重的影响，如果大key较多，容易形成性能瓶颈，甚至降低业务稳定性。 定期分析内存并根据分析结">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://www.toberoot.com/icon/og-image-wide.png">
<meta property="article:published_time" content="2025-10-22T08:53:55.873Z">
<meta property="article:modified_time" content="2025-10-22T08:49:33.404Z">
<meta property="article:author" content="魏亚萍">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.toberoot.com/icon/twitter-summary.png">
<meta property="fb:admins" content="100000247608790">
  <!-- Google Analytics -->
  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-48498357-3', 'auto');
  ga('send', 'pageview');
</script>

  <!-- Algolia -->
  <link rel="preconnect" href="https://-dsn.algolia.net" crossorigin />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3">
<meta name="generator" content="Hexo 8.0.0"></head>

<body>
  <div id="container">
    <header id="header" class="wrapper">
  <div id="header-inner" class="inner">
    <h1 id="logo-wrap">
      <a href="../../../" id="logo">Hexo</a>
    </h1>
    <nav id="main-nav">
      <a href="../../../docs/" class="main-nav-link">Hexo</a><a href="../../../news/" class="main-nav-link">News</a><a href="../../../api/" class="main-nav-link">MySQL8.0</a><a href="../../../database/" class="main-nav-link">Database</a><a href="../../../linux/" class="main-nav-link">Linux</a><a href="../../../cloud/" class="main-nav-link">Cloud</a><a href="../../../singapore/" class="main-nav-link">Singapore</a><a href="../../../amy/" class="main-nav-link">AMY</a><a href="../../../about/" class="main-nav-link">About</a>
      <a target="_blank" rel="noopener" href="https://github.com/BoobooWei" class="main-nav-link"><i class="fa fa-github-alt"></i></a>

      <div id="search-input-wrap">
        <div id="search-input-icon">
          <i class="fa fa-search"></i>
        </div>
        <input type="search" id="search-input" placeholder="Search...">
      </div>
    </nav>
    <div id="lang-select-wrap">
        <a href="/about/" class="main-nav-link"><label id="lang-select-label"><i class="fa fa-globe"></i><span>关于我</span></label></a>
    </div>
    <a id="mobile-nav-toggle">
      <span class="mobile-nav-toggle-bar"></span>
      <span class="mobile-nav-toggle-bar"></span>
      <span class="mobile-nav-toggle-bar"></span>
    </a>
  </div>
</header>

    <div id="content-wrap">
  <div id="content" class="wrapper">
    <div id="content-inner">
      <article class="article-container" itemscope itemtype="http://schema.org/Article">
        <div class="article-inner">
          <div class="article">
            <div class="inner">
              <header class="article-header">
                <h1 class="article-title" itemprop="name">Redis 运维实践</h1>
                <a target="_blank" rel="noopener" href="https://github.com/BoobooWei/site/edit/master/source/database/nosql/dba_redis/11_redis_ops.md" class="article-edit-link" title="Improve this doc"><i class="fa fa-pencil"></i></a>
              </header>
              <div class="article-content" itemprop="articleBody">
                <html><head></head><body><h1 id="Redis-内存使用率偏高" class="article-heading"><a href="#Redis-内存使用率偏高" class="headerlink" title="Redis 内存使用率偏高"></a>Redis 内存使用率偏高<a class="article-anchor" href="#Redis-内存使用率偏高" aria-hidden="true"></a></h1><h2 id="问题原因" class="article-heading"><a href="#问题原因" class="headerlink" title="问题原因"></a>问题原因<a class="article-anchor" href="#问题原因" aria-hidden="true"></a></h2><p>内存使用率居高不下很多情况下都是大Key导致的。</p>
<p>大Key一般情况下认为：String类型的Value大于10240的是大Key，List长度大于10240认为是大Key，Hash Field的数目大于10240认为是大Key。</p>
<p>Redis中的数据结构对服务的性能有着举足轻重的影响，如果大key较多，容易形成性能瓶颈，甚至降低业务稳定性。</p>
<p>定期分析内存并根据分析结果优化内存，可以保持服务的稳定和高效。</p>
<h2 id="解决建议" class="article-heading"><a href="#解决建议" class="headerlink" title="解决建议"></a>解决建议<a class="article-anchor" href="#解决建议" aria-hidden="true"></a></h2><ol>
<li>在业务低峰期定位大Key （内存分析法；Python工具法）</li>
<li>优化大Key：（根据贵司的实际业务场景进行大key的删除和优化）<ol>
<li><ol>
<li>优化big key的原则就是string减少字符串长度，list、hash、set、zset等减少成员数</li>
<li>以hash类型举例来说，对于field过多的场景，可以根据field进行hash取模，生成一个新的key，例如原来的<br>hash_key:{filed1:value, filed2:value, filed3:value …}，可以hash取模后形成如下key:value形式<br>hash_key:mod1:{filed1:value}<br>hash_key:mod2:{filed2:value}<br>hash_key:mod3:{filed3:value}<br>…<br>取模后，将原先单个key分成多个key，每个key filed个数为原先的1/N</li>
<li>string类型的big key，如文章正文，建议不要存入redis，用文档型数据库MongoDB代替或者直接缓存到CDN上等方式优化</li>
</ol>
</li>
</ol>
</li>
</ol>
<h3 id="帮助文档" class="article-heading"><a href="#帮助文档" class="headerlink" title="帮助文档"></a>帮助文档<a class="article-anchor" href="#帮助文档" aria-hidden="true"></a></h3><p>Redis内存分析方法，请详见： <a target="_blank" rel="noopener" href="https://help.aliyun.com/document_detail/141763.html">https://help.aliyun.com/document_detail/141763.html</a></p>
<p>Python工具法，请详见： <a target="_blank" rel="noopener" href="https://help.aliyun.com/knowledge_detail/56949.html">https://help.aliyun.com/knowledge_detail/56949.html</a></p>
<h1 id="批量删除redis的key" class="article-heading"><a href="#批量删除redis的key" class="headerlink" title="批量删除redis的key"></a>批量删除redis的key<a class="article-anchor" href="#批量删除redis的key" aria-hidden="true"></a></h1><blockquote>
<p>2018-02-27 驻云DBA组</p>
</blockquote>
<h2 id="需求" class="article-heading"><a href="#需求" class="headerlink" title="需求"></a>需求<a class="article-anchor" href="#需求" aria-hidden="true"></a></h2><p>redis数据清理：</p>
<p>目前在0号库中，存在一个hash键mserver_redis_requestUk，数据量达到20G左右，需要在不影响生成环境的情况下，删除该Key。</p>
<h2 id="解决方法" class="article-heading"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法<a class="article-anchor" href="#解决方法" aria-hidden="true"></a></h2><h3 id="思路" class="article-heading"><a href="#思路" class="headerlink" title="思路"></a>思路<a class="article-anchor" href="#思路" aria-hidden="true"></a></h3><p>从Redis2.8版本开始支持HSCAN命令，通过m次时间复杂度为O(1)的方式，遍历包含n个元素的大key。</p>
<p>**这样可以避免单个O(n)的大命令，从而避免Redis阻塞。 **</p>
<p>HSCAN 命令返回的每个元素都是一个键值对，一个键值对由一个键和一个值组成。</p>
<h3 id="具体操作" class="article-heading"><a href="#具体操作" class="headerlink" title="具体操作"></a>具体操作<a class="article-anchor" href="#具体操作" aria-hidden="true"></a></h3><p>通过hscan命令，每次获取500个字段，再用hdel命令，每次删除1个字段。<br>Python代码：</p>
<figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-*- coding:utf-8 -*-</span></span><br><span class="line">import redis</span><br><span class="line"></span><br><span class="line">def del_large_hash():</span><br><span class="line">    r = redis.StrictRedis(host='云redis地址', port=6379, password='密码')</span><br><span class="line">    large_hash_key ="mserver_redis_requestUk" #要删除的大hash键名</span><br><span class="line">    cursor = '0'</span><br><span class="line">    cursor, data = r.hscan(large_hash_key, cursor=cursor, count=500)</span><br><span class="line">    for item in data.items():</span><br><span class="line">        r.hdel(large_hash_key, item[0])</span><br><span class="line"></span><br><span class="line">del_large_hash()</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>准备一台ECS服务器可以访问云redis</li>
<li>python 版本 &gt;= 2.7</li>
<li>安装python的redis包，命令如下</li>
</ul>
<figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line">pip install redis</span><br></pre></td></tr></tbody></table></figure>

<p>准备好环境和脚本后，就可以优雅的删除大Key了。</p>
<h2 id="总结" class="article-heading"><a href="#总结" class="headerlink" title="总结"></a>总结<a class="article-anchor" href="#总结" aria-hidden="true"></a></h2><ul>
<li><p>该方法每次获取500个字段，再用hdel命令，每次删除1个字段；</p>
</li>
<li><p>通过m次时间复杂度为O(1)的方式，遍历大key<code>mserver_redis_requestUk</code>；</p>
</li>
<li><p>m=大key的总字段/500 ；</p>
</li>
<li><p>每次获取的字段数，可以在脚本中自行调整。</p>
</li>
</ul>
<p>**Hscan实现增量迭代从而避免Redis阻塞。 **</p>
<h1 id="Redis-迁移合并" class="article-heading"><a href="#Redis-迁移合并" class="headerlink" title="Redis 迁移合并"></a>Redis 迁移合并<a class="article-anchor" href="#Redis-迁移合并" aria-hidden="true"></a></h1><blockquote>
<p>2018-06-22 大宝</p>
</blockquote>
<p>[TOC]</p>
<h2 id="需求-1" class="article-heading"><a href="#需求-1" class="headerlink" title="需求"></a>需求<a class="article-anchor" href="#需求-1" aria-hidden="true"></a></h2><p>目前client中存在db0，db1，db2，test库中存在db0，db1。<br>客户希望将test库中的数据与client合并，且不覆盖client库。</p>
<h2 id="调研情况" class="article-heading"><a href="#调研情况" class="headerlink" title="调研情况"></a>调研情况<a class="article-anchor" href="#调研情况" aria-hidden="true"></a></h2><p>目前test中存在db0，db1，client中也有db0，db1。</p>
<figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">client Keyspace</span></span><br><span class="line">db0:keys=186,expires=4,avg_ttl=6348143</span><br><span class="line">db1:keys=192,expires=9,avg_ttl=281534</span><br><span class="line">db2:keys=1,expires=0,avg_ttl=0</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">test</span> Keyspace</span></span><br><span class="line">db0:keys=25113,expires=103,avg_ttl=31130691210</span><br><span class="line">db1:keys=954,expires=0,avg_ttl=0</span><br></pre></td></tr></tbody></table></figure>

<ol>
<li><p>合并两个库，目前客户是否使用了命名空间，来区分key呢？</p>
</li>
<li><p>若客户使用了命名空间，则合并可以保证数据一致性，合并方法使用逻辑备份和导入即可：redis-dump 和redis-load命令</p>
</li>
<li><p>若客户没有使用命名空间，则合并时遇到有冲突的key，会自动跳过，只保留目标库中的key，导致数据不一致。需要客户判断是否能够接受数据的不一致性。</p>
</li>
</ol>
<p><strong>客户反馈key的命名空间有些有，有些没有。因此请客户考虑上述第三点。</strong></p>
<p><strong>A</strong>: 可以接受数据不一致，冲突时保留目标库的key</p>
<h2 id="迁移数据" class="article-heading"><a href="#迁移数据" class="headerlink" title="迁移数据"></a>迁移数据<a class="article-anchor" href="#迁移数据" aria-hidden="true"></a></h2><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line"># 备份test</span><br><span class="line">[root@xym-csos-server ~]# redis-dump -u :6FtkIazwqzC@r-bp114417c5d282b4.redis.rds.aliyuncs.com:6379 &gt; redis_test.json</span><br><span class="line"></span><br><span class="line"># 为了保险也备份client</span><br><span class="line">[root@xym-csos-server ~]# redis-dump -u :KIU495bIqL@r-bp1cdd51ee8a8824.redis.rds.aliyuncs.com:6379 &gt; redis-client.json</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@xym-csos-server ~]# ll -h</span><br><span class="line">total 42M</span><br><span class="line">-rw-r--r-- 1 root root 602K Jun 22 22:03 redis-client.json</span><br><span class="line">-rw-r--r-- 1 root root  42M Jun 22 22:03 redis_test.json</span><br><span class="line">-rwxr-xr-x 1 root root 5.0K Jun 21 14:30 zabbix_proxy-3.2.1.sh</span><br><span class="line"></span><br><span class="line"># 将test导入client，报错utf8编码问题</span><br><span class="line"></span><br><span class="line">[root@xym-csos-server ~]# redis-load -u :xxx@r-bp1cdd51ee8a8824.redis.rds.aliyuncs.com:6379 &lt; redis_test.json</span><br><span class="line">ERROR (Yajl::ParseError): lexical error: invalid bytes in UTF8 string.</span><br><span class="line">          ","value":"\u0000\u000F\u0004󮮰BappHostName󮮰B10.10.</span><br><span class="line">                     (right here) ------^</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#如果报错，请使用-n选项，使用请参考官方，请谨慎使用！</span><br><span class="line">#&lt; test.json redis-load -n    //-n （以二进制形式导入）</span><br><span class="line"></span><br><span class="line">Loading data with binary strings</span><br><span class="line">If you have binary or serialized data in your Redis database, the YAJL parser may not load your dump file because it sees some of the binary data as 'invalid bytes in UTF8 string'. If you are certain that your data is binary and not malformed UTF8, you can use the -n flag to redis-load to tell YAJL to not check the input for UTF8 validity. Use with caution!</span><br><span class="line"></span><br><span class="line"># 添加-n参数以二进制方式导入</span><br><span class="line"></span><br><span class="line">[root@xym-csos-server ~]# redis-load -n -u :xxx@r-bp1cdd51ee8a8824.redis.rds.aliyuncs.com:6379 &lt; redis_test.json</span><br><span class="line"></span><br><span class="line"># 查看当前的client情况如下</span><br><span class="line"></span><br><span class="line">r-bp1cdd51ee8a8824.redis.rds.aliyuncs.com:6379&gt;info</span><br><span class="line"># Server</span><br><span class="line">redis_version:2.8.19</span><br><span class="line">redis_git_sha1:84975300</span><br><span class="line">redis_git_dirty:1</span><br><span class="line">redis_build_id:716ab38e57364d4</span><br><span class="line">redis_mode:standalone</span><br><span class="line">os:Linux</span><br><span class="line">arch_bits:64</span><br><span class="line">multiplexing_api:epoll</span><br><span class="line">gcc_version:0.0.0</span><br><span class="line">process_id:51718</span><br><span class="line">run_id:36c0d2baa517fad865786cff19a3b00d1497981a</span><br><span class="line">server_id:0</span><br><span class="line">tcp_port:6379</span><br><span class="line">uptime_in_seconds:2362924</span><br><span class="line">uptime_in_days:27</span><br><span class="line">hz:10</span><br><span class="line">lru_clock:2949784</span><br><span class="line">config_file:redis.conf</span><br><span class="line"># Clients</span><br><span class="line">connected_clients:75</span><br><span class="line">client_longest_output_list:0</span><br><span class="line">client_biggest_input_buf:0</span><br><span class="line">blocked_clients:0</span><br><span class="line"># Memory</span><br><span class="line">used_memory:34908112</span><br><span class="line">used_memory_human:33.29M</span><br><span class="line">used_memory_rss:34844672</span><br><span class="line">used_memory_peak:35549288</span><br><span class="line">used_memory_peak_human:33.90M</span><br><span class="line">used_memory_lua:45056</span><br><span class="line">mem_fragmentation_ratio:1.00</span><br><span class="line">mem_allocator:jemalloc-3.6.0</span><br><span class="line"># Stats</span><br><span class="line">total_connections_received:524441</span><br><span class="line">total_commands_processed:25328930</span><br><span class="line">instantaneous_ops_per_sec:6</span><br><span class="line">total_net_input_bytes:1092820494</span><br><span class="line">total_net_output_bytes:6478654065</span><br><span class="line">instantaneous_input_kbps:0.11</span><br><span class="line">instantaneous_output_kbps:2.47</span><br><span class="line">input_limit_tokens:31457280</span><br><span class="line">output_limit_tokens:31457275</span><br><span class="line">input_strict_limit:0</span><br><span class="line">output_strict_limit:0</span><br><span class="line">rejected_connections:0</span><br><span class="line">rejected_connections_status:0</span><br><span class="line">sync_full:0</span><br><span class="line">sync_partial_ok:0</span><br><span class="line">sync_partial_err:0</span><br><span class="line">expired_keys:116358</span><br><span class="line">evicted_keys:0</span><br><span class="line">evicted_keys_per_sec:0</span><br><span class="line">keyspace_hits:1521054</span><br><span class="line">keyspace_misses:759414</span><br><span class="line">hits_per_sec:0.00</span><br><span class="line">misses_per_sec:0.00</span><br><span class="line">hit_rate_percentage:100.00</span><br><span class="line">pubsub_channels:0</span><br><span class="line">pubsub_patterns:66</span><br><span class="line">latest_fork_usec:692</span><br><span class="line">traffic_control_read:0</span><br><span class="line">traffic_control_read_status:0</span><br><span class="line">traffic_control_write:0</span><br><span class="line">traffic_control_write_status:0</span><br><span class="line">total_bigkeys:0</span><br><span class="line">bigkeys_status:0</span><br><span class="line">stat_avg_rt:0</span><br><span class="line">stat_max_rt:867</span><br><span class="line"># CPU</span><br><span class="line">used_cpu_sys:1394.92</span><br><span class="line">used_cpu_user:1545.75</span><br><span class="line">used_cpu_sys_children:0.06</span><br><span class="line">used_cpu_user_children:0.06</span><br><span class="line"># Keyspace</span><br><span class="line">db0:keys=25302,expires=110,avg_ttl=19648674653</span><br><span class="line">db1:keys=1089,expires=3,avg_ttl=2588349</span><br><span class="line">db2:keys=1,expires=0,avg_ttl=0</span><br><span class="line"># Cluster</span><br><span class="line">databases:256</span><br><span class="line">nodecount:1</span><br><span class="line"># SSL</span><br><span class="line">ssl_enabled:0</span><br><span class="line">ssl_protocols:TLSv1,TLSv1.1,TLSv1.2</span><br><span class="line">ssl_client_count:0</span><br><span class="line">ssl_accept_count:0</span><br><span class="line">ssl_reject_count:0</span><br></pre></td></tr></tbody></table></figure>

<h2 id="总结-1" class="article-heading"><a href="#总结-1" class="headerlink" title="总结"></a>总结<a class="article-anchor" href="#总结-1" aria-hidden="true"></a></h2><ol>
<li>物理备份恢复redis-port reload代表全量导入；sync代表全量加增量</li>
<li>逻辑备份恢复redis-dump redis-load</li>
</ol>
<h1 id="Redis-常见报错解决" class="article-heading"><a href="#Redis-常见报错解决" class="headerlink" title="Redis 常见报错解决"></a>Redis 常见报错解决<a class="article-anchor" href="#Redis-常见报错解决" aria-hidden="true"></a></h1><h2 id="RDB失败以及AOF文件异常大" class="article-heading"><a href="#RDB失败以及AOF文件异常大" class="headerlink" title="RDB失败以及AOF文件异常大"></a>RDB失败以及AOF文件异常大<a class="article-anchor" href="#RDB失败以及AOF文件异常大" aria-hidden="true"></a></h2><h3 id="报错原因" class="article-heading"><a href="#报错原因" class="headerlink" title="报错原因"></a>报错原因<a class="article-anchor" href="#报错原因" aria-hidden="true"></a></h3><figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line">redis从库报错：</span><br><span class="line">7022:S 23 Jul 21:30:10.681 * Starting automatic rewriting of AOF on 232547% growth</span><br><span class="line">7022:S 23 Jul 21:30:10.681 # Can't rewrite append only file in background: fork: Cannot allocate memory</span><br></pre></td></tr></tbody></table></figure>

<h3 id="原因和解决" class="article-heading"><a href="#原因和解决" class="headerlink" title="原因和解决"></a>原因和解决<a class="article-anchor" href="#原因和解决" aria-hidden="true"></a></h3><p>在线关闭从库aof功能</p>
<figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line">172.16.1.167:6379&gt; CONFIG SET appendonly no</span><br><span class="line">OK</span><br></pre></td></tr></tbody></table></figure>

<p>删除aof文件</p>
<figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line">rm ‐rf appendonly.aof</span><br></pre></td></tr></tbody></table></figure>

<p>从库无法固化以及aof文件出错原因<br>当Redis内存使用量约超过物理内存一半时，Redis在fork进程进行bgsave或者BGREWRITEAOF时将会失败，此时无法rdb持久化以及AOF rewrite，通常在日志中可以看到：<br><code>Can't save in background: fork: Cannot allocate memory</code><br>这种情况，可以将Linux的<code>vm.overcommit_memory = 1</code>，但理论上也会存在风险，如果在rdb dump期间业务有相当多的数据更新，将会导致系统内存不足而发生OOM<br>所以如果业务无需固化数据，直接将rdb和aof都关闭即可。</p>
<h2 id="MISCONF" class="article-heading"><a href="#MISCONF" class="headerlink" title="MISCONF"></a>MISCONF<a class="article-anchor" href="#MISCONF" aria-hidden="true"></a></h2><h3 id="报错明细" class="article-heading"><a href="#报错明细" class="headerlink" title="报错明细"></a>报错明细<a class="article-anchor" href="#报错明细" aria-hidden="true"></a></h3><figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line">MISCONF Redis is configured to save RDB snapshots, but it is currently not able to persist on disk. Commands that may modify the data set are disabled, because this instance is configured to report errors during writes if RDB snapshotting fails (stop-writes-on-bgsave-error option). Please check the Redis logs for details about the RDB error.</span><br></pre></td></tr></tbody></table></figure>

<h3 id="原因和解决-1" class="article-heading"><a href="#原因和解决-1" class="headerlink" title="原因和解决"></a>原因和解决<a class="article-anchor" href="#原因和解决-1" aria-hidden="true"></a></h3><p>其原因是因为强制把<code>redis</code>快照关闭了导致不能持久化的问题，在网上查了一些相关解决方案，通过<code>stop-writes-on-bgsave-error</code>值设置为<code>no</code>即可避免这种问题。</p>
<p>有两种修改方法，一种是通过redis命令行修改，另一种是直接修改redis.conf配置文件</p>
<p>命令行修改方式示例：</p>
<p><code>127.0.0.1:6379&gt; config set stop-writes-on-bgsave-error no</code></p>
<p>修改<code>redis.conf</code>文件：<code>stop-writes-on-bgsave-error</code>字符串所在位置，接着把后面的<code>yes</code>设置为<code>no</code>即可。</p>
<h1 id="centos6-5-安装ruby-2-3-1" class="article-heading"><a href="#centos6-5-安装ruby-2-3-1" class="headerlink" title="centos6.5 安装ruby 2.3.1"></a>centos6.5 安装ruby 2.3.1<a class="article-anchor" href="#centos6-5-安装ruby-2-3-1" aria-hidden="true"></a></h1><blockquote>
<p>2018-06-25 Booboowei</p>
</blockquote>
<h2 id="步骤概览" class="article-heading"><a href="#步骤概览" class="headerlink" title="步骤概览"></a>步骤概览<a class="article-anchor" href="#步骤概览" aria-hidden="true"></a></h2><figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">现在的版本</span></span><br><span class="line">[root@hd4 /]# ruby --version</span><br><span class="line">ruby 1.8.7 (2013-06-27 patchlevel 374) [x86_64-linux]</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">升级过程</span></span><br><span class="line">[root@hd4 /]# curl -sSL https://rvm.io/mpapis.asc | gpg2 --import -</span><br><span class="line">[root@hd4 /]# curl -L get.rvm.io | bash -s stable</span><br><span class="line">[root@hd4 /]# source /etc/profile.d/rvm.sh</span><br><span class="line">[root@hd4 /]# rvm requirements</span><br><span class="line">[root@hd4 /]# rvm install ruby 2.3.1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">设置默认版本</span></span><br><span class="line">[root@hd4 /]# rvm --default use 2.3.1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">检查安装结果</span></span><br><span class="line">[root@hd4 /]# ruby -v</span><br><span class="line">ruby 2.3.1p112 (2016-04-26 revision 54768) [x86_64-linux]</span><br></pre></td></tr></tbody></table></figure>

<h2 id="操作明细" class="article-heading"><a href="#操作明细" class="headerlink" title="操作明细"></a>操作明细<a class="article-anchor" href="#操作明细" aria-hidden="true"></a></h2><figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line">[root@xym-csos-server ~]# which ruby</span><br><span class="line">/usr/bin/ruby</span><br><span class="line">[root@xym-csos-server ~]# ruby -v</span><br><span class="line">ruby 1.8.7 (2013-06-27 patchlevel 374) [x86_64-linux]</span><br><span class="line">[root@xym-csos-server ~]#  curl -sSL https://rvm.io/mpapis.asc | gpg2 --import -</span><br><span class="line">gpg: directory `/root/.gnupg' created</span><br><span class="line">gpg: new configuration file `/root/.gnupg/gpg.conf' created</span><br><span class="line">gpg: WARNING: options in `/root/.gnupg/gpg.conf' are not yet active during this run</span><br><span class="line">gpg: keyring `/root/.gnupg/secring.gpg' created</span><br><span class="line">gpg: keyring `/root/.gnupg/pubring.gpg' created</span><br><span class="line">gpg: /root/.gnupg/trustdb.gpg: trustdb created</span><br><span class="line">gpg: key D39DC0E3: public key "Michal Papis (RVM signing) &lt;mpapis@gmail.com&gt;" imported</span><br><span class="line">gpg: Total number processed: 1</span><br><span class="line">gpg:               imported: 1  (RSA: 1)</span><br><span class="line">gpg: no ultimately trusted keys found</span><br><span class="line">[root@xym-csos-server ~]#  curl -L get.rvm.io | bash -s stable</span><br><span class="line"><span class="meta prompt_">  % </span><span class="language-bash">Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span></span><br><span class="line">                                 Dload  Upload   Total   Spent    Left  Speed</span><br><span class="line">100 24361  100 24361    0     0   5412      0  0:00:04  0:00:04 --:--:-- 24458</span><br><span class="line">Downloading https://github.com/rvm/rvm/archive/1.29.3.tar.gz</span><br><span class="line">Downloading https://github.com/rvm/rvm/releases/download/1.29.3/1.29.3.tar.gz.asc</span><br><span class="line">gpg: Signature made Mon 11 Sep 2017 04:59:21 AM CST using RSA key ID BF04FF17</span><br><span class="line">gpg: Good signature from "Michal Papis (RVM signing) &lt;mpapis@gmail.com&gt;"</span><br><span class="line">gpg:                 aka "Michal Papis &lt;michal.papis@toptal.com&gt;"</span><br><span class="line">gpg:                 aka "[jpeg image of size 5015]"</span><br><span class="line">gpg: WARNING: This key is not certified with a trusted signature!</span><br><span class="line">gpg:          There is no indication that the signature belongs to the owner.</span><br><span class="line">Primary key fingerprint: 409B 6B17 96C2 7546 2A17  0311 3804 BB82 D39D C0E3</span><br><span class="line">     Subkey fingerprint: 62C9 E5F4 DA30 0D94 AC36  166B E206 C29F BF04 FF17</span><br><span class="line">GPG verified '/usr/local/rvm/archives/rvm-1.29.3.tgz'</span><br><span class="line">Creating group 'rvm'</span><br><span class="line"></span><br><span class="line">Installing RVM to /usr/local/rvm/</span><br><span class="line">Installation of RVM in /usr/local/rvm/ is almost complete:</span><br><span class="line"></span><br><span class="line">  * First you need to add all users that will be using rvm to 'rvm' group,</span><br><span class="line">    and logout - login again, anyone using rvm will be operating with `umask u=rwx,g=rwx,o=rx`.</span><br><span class="line"></span><br><span class="line">  * To start using RVM you need to run `source /etc/profile.d/rvm.sh`</span><br><span class="line">    in all your open shell windows, in rare cases you need to reopen all shell windows.</span><br><span class="line">[root@xym-csos-server ~]# source /etc/profile.d/rvm.sh</span><br><span class="line">[root@xym-csos-server ~]# rvm requirements</span><br><span class="line">Checking requirements for centos.</span><br><span class="line">Installing requirements for centos.</span><br><span class="line">Installing required packages: bison, gcc-c++, libffi-devel, libtool, readline-devel, sqlite-devel, libyaml-devel...........</span><br><span class="line">Requirements installation successful.</span><br><span class="line">[root@xym-csos-server ~]# rvm install ruby 2.3.1</span><br><span class="line">Searching for binary rubies, this might take some time.</span><br><span class="line">Found remote file https://rvm_io.global.ssl.fastly.net/binaries/centos/6/x86_64/ruby-2.3.1.tar.bz2</span><br><span class="line">Checking requirements for centos.</span><br><span class="line">Requirements installation successful.</span><br><span class="line">ruby-2.3.1 - #configure</span><br><span class="line">ruby-2.3.1 - #download</span><br><span class="line"><span class="meta prompt_">  % </span><span class="language-bash">Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span></span><br><span class="line">                                 Dload  Upload   Total   Spent    Left  Speed</span><br><span class="line">100 22.5M  100 22.5M    0     0  3730k      0  0:00:06  0:00:06 --:--:-- 6659k</span><br><span class="line">ruby-2.3.1 - #validate archive</span><br><span class="line">ruby-2.3.1 - #extract</span><br><span class="line">ruby-2.3.1 - #validate binary</span><br><span class="line">ruby-2.3.1 - #setup</span><br><span class="line">ruby-2.3.1 - #gemset created /usr/local/rvm/gems/ruby-2.3.1@global</span><br><span class="line">ruby-2.3.1 - #importing gemset /usr/local/rvm/gemsets/global.gems...................................</span><br><span class="line">ruby-2.3.1 - #generating global wrappers........</span><br><span class="line">ruby-2.3.1 - #gemset created /usr/local/rvm/gems/ruby-2.3.1</span><br><span class="line">ruby-2.3.1 - #importing gemsetfile /usr/local/rvm/gemsets/default.gems evaluated to empty gem list</span><br><span class="line">ruby-2.3.1 - #generating default wrappers........</span><br><span class="line">[root@xym-csos-server ~]# rvm --default use 2.3.1</span><br><span class="line">Using /usr/local/rvm/gems/ruby-2.3.1</span><br><span class="line">[root@xym-csos-server ~]# ruby -v</span><br><span class="line">ruby 2.3.1p112 (2016-04-26 revision 54768) [x86_64-linux]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">root@xym-csos-server ~]# which gem</span><br><span class="line">/usr/local/rvm/rubies/ruby-2.3.1/bin/gem</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@xym-csos-server ~]# gem install redis-dump -V</span><br><span class="line">GET https://rubygems.org/latest_specs.4.8.gz</span><br><span class="line">200 OK</span><br><span class="line">GET https://rubygems.org/quick/Marshal.4.8/redis-dump-0.4.0.gemspec.rz</span><br><span class="line">200 OK</span><br><span class="line">GET https://rubygems.org/specs.4.8.gz</span><br><span class="line">200 OK</span><br><span class="line">GET https://rubygems.org/quick/Marshal.4.8/yajl-ruby-1.4.0.gemspec.rz</span><br><span class="line">200 OK</span><br><span class="line">GET https://rubygems.org/quick/Marshal.4.8/redis-4.0.1.gemspec.rz</span><br><span class="line">200 OK</span><br><span class="line">GET https://rubygems.org/quick/Marshal.4.8/uri-redis-0.4.2.gemspec.rz</span><br><span class="line">200 OK</span><br><span class="line">GET https://rubygems.org/quick/Marshal.4.8/drydock-0.6.9.gemspec.rz</span><br><span class="line">200 OK</span><br><span class="line">Downloading gem yajl-ruby-1.4.0.gem</span><br><span class="line">GET https://rubygems.org/gems/yajl-ruby-1.4.0.gem</span><br><span class="line">Fetching: yajl-ruby-1.4.0.gem (100%)</span><br><span class="line">200 OK</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/.codeclimate.yml</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/.gitignore</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/.rspec</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/.travis.yml</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/CHANGELOG.md</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/Gemfile</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/LICENSE</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/README.md</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/Rakefile</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/benchmark/encode.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/benchmark/encode_json_and_marshal.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/benchmark/encode_json_and_yaml.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/benchmark/http.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/benchmark/parse.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/benchmark/parse_json_and_marshal.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/benchmark/parse_json_and_yaml.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/benchmark/parse_stream.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/benchmark/subjects/item.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/benchmark/subjects/ohai.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/benchmark/subjects/ohai.marshal_dump</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/benchmark/subjects/ohai.yml</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/benchmark/subjects/twitter_search.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/benchmark/subjects/twitter_stream.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/benchmark/subjects/unicode.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/examples/encoding/chunked_encoding.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/examples/encoding/one_shot.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/examples/encoding/to_an_io.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/examples/http/twitter_search_api.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/examples/http/twitter_stream_api.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/examples/parsing/from_file.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/examples/parsing/from_stdin.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/examples/parsing/from_string.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/ext/yajl/api/yajl_common.h</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/ext/yajl/api/yajl_gen.h</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/ext/yajl/api/yajl_parse.h</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/ext/yajl/api/yajl_version.h</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/ext/yajl/extconf.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/ext/yajl/yajl.c</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/ext/yajl/yajl_alloc.c</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/ext/yajl/yajl_alloc.h</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/ext/yajl/yajl_buf.c</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/ext/yajl/yajl_buf.h</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/ext/yajl/yajl_bytestack.h</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/ext/yajl/yajl_encode.c</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/ext/yajl/yajl_encode.h</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/ext/yajl/yajl_ext.c</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/ext/yajl/yajl_ext.h</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/ext/yajl/yajl_gen.c</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/ext/yajl/yajl_lex.c</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/ext/yajl/yajl_lex.h</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/ext/yajl/yajl_parser.c</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/ext/yajl/yajl_parser.h</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/ext/yajl/yajl_version.c</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/lib/yajl.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/lib/yajl/bzip2.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/lib/yajl/bzip2/stream_reader.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/lib/yajl/bzip2/stream_writer.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/lib/yajl/deflate.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/lib/yajl/deflate/stream_reader.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/lib/yajl/deflate/stream_writer.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/lib/yajl/gzip.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/lib/yajl/gzip/stream_reader.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/lib/yajl/gzip/stream_writer.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/lib/yajl/http_stream.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/lib/yajl/json_gem.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/lib/yajl/json_gem/encoding.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/lib/yajl/json_gem/parsing.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/lib/yajl/version.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/script/bootstrap</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/encoding/encoding_spec.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/global/global_spec.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/http/fixtures/http.bzip2.dump</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/http/fixtures/http.chunked.dump</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/http/fixtures/http.deflate.dump</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/http/fixtures/http.error.dump</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/http/fixtures/http.gzip.dump</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/http/fixtures/http.html.dump</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/http/fixtures/http.raw.dump</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/http/http_delete_spec.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/http/http_error_spec.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/http/http_get_spec.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/http/http_post_spec.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/http/http_put_spec.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/http/http_stream_options_spec.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/json_gem_compatibility/compatibility_spec.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/active_support_spec.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/chunked_spec.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/fail.15.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/fail.16.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/fail.17.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/fail.26.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/fail11.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/fail12.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/fail13.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/fail14.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/fail19.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/fail20.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/fail21.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/fail22.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/fail23.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/fail24.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/fail25.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/fail27.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/fail28.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/fail3.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/fail4.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/fail5.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/fail6.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/fail9.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.array.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.codepoints_from_unicode_org.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.contacts.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.db100.xml.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.db1000.xml.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.dc_simple_with_comments.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.deep_arrays.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.difficult_json_c_test_case.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.difficult_json_c_test_case_with_comments.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.doubles.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.empty_array.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.empty_string.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.escaped_bulgarian.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.escaped_foobar.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.item.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.json-org-sample1.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.json-org-sample2.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.json-org-sample3.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.json-org-sample4-nows.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.json-org-sample4.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.json-org-sample5.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.map-spain.xml.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.ns-invoice100.xml.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.ns-soap.xml.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.numbers-fp-4k.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.numbers-fp-64k.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.numbers-int-4k.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.numbers-int-64k.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.twitter-search.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.twitter-search2.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.unicode.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass.yelp.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass1.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass2.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures/pass3.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/fixtures_spec.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/large_number_spec.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/parsing/one_off_spec.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/projection/project_file.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/projection/projection.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/rcov.opts</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/spec/spec_helper.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/tasks/compile.rake</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/tasks/rspec.rake</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/yajl-ruby-1.4.0/yajl-ruby.gemspec</span><br><span class="line">Building native extensions.  This could take a while...</span><br><span class="line">/usr/local/rvm/rubies/ruby-2.3.1/bin/ruby extconf.rb</span><br><span class="line">creating Makefile</span><br><span class="line">make "DESTDIR="</span><br><span class="line">compiling yajl_buf.c</span><br><span class="line">compiling yajl_lex.c</span><br><span class="line">yajl_lex.c: In function ‘yajl_tok_name’:</span><br><span class="line">yajl_lex.c:42: warning: enumeration value ‘yajl_tok_comment’ not handled in switch</span><br><span class="line">compiling yajl_version.c</span><br><span class="line">compiling yajl_parser.c</span><br><span class="line">compiling yajl_encode.c</span><br><span class="line">compiling yajl_ext.c</span><br><span class="line">compiling yajl_gen.c</span><br><span class="line">compiling yajl_alloc.c</span><br><span class="line">compiling yajl.c</span><br><span class="line">linking shared-object yajl/yajl.so</span><br><span class="line">make "DESTDIR=" install</span><br><span class="line">/usr/bin/install -c -m 0755 yajl.so ./.gem.20180622-9454-y24tn4/yajl</span><br><span class="line"></span><br><span class="line">Successfully installed yajl-ruby-1.4.0</span><br><span class="line">Downloading gem redis-4.0.1.gem</span><br><span class="line">GET https://rubygems.org/gems/redis-4.0.1.gem</span><br><span class="line">Fetching: redis-4.0.1.gem (100%)</span><br><span class="line">200 OK</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/.gitignore</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/.travis.yml</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/.travis/Gemfile</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/.yardopts</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/CHANGELOG.md</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/Gemfile</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/LICENSE</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/README.md</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/benchmarking/logging.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/benchmarking/pipeline.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/benchmarking/speed.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/benchmarking/suite.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/benchmarking/worker.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/bors.toml</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/examples/basic.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/examples/consistency.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/examples/dist_redis.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/examples/incr-decr.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/examples/list.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/examples/pubsub.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/examples/sentinel.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/examples/sentinel/sentinel.conf</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/examples/sentinel/start</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/examples/sets.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/examples/unicorn/config.ru</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/examples/unicorn/unicorn.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/lib/redis.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/lib/redis/client.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/lib/redis/connection.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/lib/redis/connection/command_helper.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/lib/redis/connection/hiredis.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/lib/redis/connection/registry.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/lib/redis/connection/ruby.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/lib/redis/connection/synchrony.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/lib/redis/distributed.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/lib/redis/errors.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/lib/redis/hash_ring.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/lib/redis/pipeline.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/lib/redis/subscribe.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/lib/redis/version.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/makefile</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/redis.gemspec</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/bitpos_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/blocking_commands_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/client_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/command_map_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/commands_on_hashes_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/commands_on_hyper_log_log_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/commands_on_lists_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/commands_on_sets_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/commands_on_sorted_sets_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/commands_on_strings_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/commands_on_value_types_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/connection_handling_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/connection_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/db/.gitkeep</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/distributed_blocking_commands_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/distributed_commands_on_hashes_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/distributed_commands_on_hyper_log_log_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/distributed_commands_on_lists_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/distributed_commands_on_sets_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/distributed_commands_on_sorted_sets_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/distributed_commands_on_strings_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/distributed_commands_on_value_types_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/distributed_commands_requiring_clustering_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/distributed_connection_handling_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/distributed_internals_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/distributed_key_tags_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/distributed_persistence_control_commands_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/distributed_publish_subscribe_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/distributed_remote_server_control_commands_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/distributed_scripting_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/distributed_sorting_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/distributed_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/distributed_transactions_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/encoding_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/error_replies_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/fork_safety_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/helper.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/helper_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/internals_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/lint/blocking_commands.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/lint/hashes.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/lint/hyper_log_log.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/lint/lists.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/lint/sets.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/lint/sorted_sets.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/lint/strings.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/lint/value_types.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/persistence_control_commands_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/pipelining_commands_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/publish_subscribe_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/remote_server_control_commands_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/scanning_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/scripting_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/sentinel_command_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/sentinel_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/sorting_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/ssl_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/support/connection/hiredis.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/support/connection/ruby.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/support/connection/synchrony.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/support/redis_mock.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/support/ssl/gen_certs.sh</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/support/ssl/trusted-ca.crt</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/support/ssl/trusted-ca.key</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/support/ssl/trusted-cert.crt</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/support/ssl/trusted-cert.key</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/support/ssl/untrusted-ca.crt</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/support/ssl/untrusted-ca.key</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/support/ssl/untrusted-cert.crt</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/support/ssl/untrusted-cert.key</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/support/wire/synchrony.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/support/wire/thread.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/synchrony_driver.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/test.conf.erb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/thread_safety_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/transactions_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/unknown_commands_test.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-4.0.1/test/url_param_test.rb</span><br><span class="line">Successfully installed redis-4.0.1</span><br><span class="line">Downloading gem uri-redis-0.4.2.gem</span><br><span class="line">GET https://rubygems.org/gems/uri-redis-0.4.2.gem</span><br><span class="line">Fetching: uri-redis-0.4.2.gem (100%)</span><br><span class="line">200 OK</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/uri-redis-0.4.2/CHANGES.txt</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/uri-redis-0.4.2/LICENSE.txt</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/uri-redis-0.4.2/README.rdoc</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/uri-redis-0.4.2/Rakefile</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/uri-redis-0.4.2/VERSION.yml</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/uri-redis-0.4.2/lib/uri/redis.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/uri-redis-0.4.2/try/10_uri_redis_try.rb</span><br><span class="line">Successfully installed uri-redis-0.4.2</span><br><span class="line">Downloading gem drydock-0.6.9.gem</span><br><span class="line">GET https://rubygems.org/gems/drydock-0.6.9.gem</span><br><span class="line">Fetching: drydock-0.6.9.gem (100%)</span><br><span class="line">200 OK</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/drydock-0.6.9/CHANGES.txt</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/drydock-0.6.9/LICENSE.txt</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/drydock-0.6.9/README.rdoc</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/drydock-0.6.9/Rakefile</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/drydock-0.6.9/bin/example</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/drydock-0.6.9/drydock.gemspec</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/drydock-0.6.9/lib/drydock.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/drydock-0.6.9/lib/drydock/console.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/drydock-0.6.9/lib/drydock/mixins.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/drydock-0.6.9/lib/drydock/mixins/object.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/drydock-0.6.9/lib/drydock/mixins/string.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/drydock-0.6.9/lib/drydock/screen.rb</span><br><span class="line">Successfully installed drydock-0.6.9</span><br><span class="line">Downloading gem redis-dump-0.4.0.gem</span><br><span class="line">GET https://rubygems.org/gems/redis-dump-0.4.0.gem</span><br><span class="line">Fetching: redis-dump-0.4.0.gem (100%)</span><br><span class="line">200 OK</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-dump-0.4.0/CHANGES.txt</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-dump-0.4.0/LICENSE.txt</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-dump-0.4.0/README.rdoc</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-dump-0.4.0/Rakefile</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-dump-0.4.0/VERSION</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-dump-0.4.0/bin/redis-dump</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-dump-0.4.0/bin/redis-load</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-dump-0.4.0/bin/redis-report</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-dump-0.4.0/gem-public_cert.pem</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-dump-0.4.0/lib/redis/dump.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-dump-0.4.0/redis-dump.gemspec</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-dump-0.4.0/try/10_redis_dump_try.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-dump-0.4.0/try/20_dump_specific_keys_try.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-dump-0.4.0/try/30_dump_base64_try.rb</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-dump-0.4.0/try/db0.json</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/gems/redis-dump-0.4.0/try/redis.conf</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/bin/redis-dump</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/bin/redis-load</span><br><span class="line">/usr/local/rvm/gems/ruby-2.3.1/bin/redis-report</span><br><span class="line">Successfully installed redis-dump-0.4.0</span><br><span class="line">Parsing documentation for drydock-0.6.9</span><br><span class="line">Parsing sources...</span><br><span class="line"><span class="meta prompt_">100% </span><span class="language-bash">[ 9/ 9]  lib/drydock/screen.rb</span></span><br><span class="line">Installing ri documentation for drydock-0.6.9</span><br><span class="line">Parsing documentation for redis-4.0.1</span><br><span class="line">Parsing sources...</span><br><span class="line"><span class="meta prompt_">100% </span><span class="language-bash">[14/14]  lib/redis/version.rb</span></span><br><span class="line">Installing ri documentation for redis-4.0.1</span><br><span class="line">Parsing documentation for redis-dump-0.4.0</span><br><span class="line">Parsing sources...</span><br><span class="line"><span class="meta prompt_">100% </span><span class="language-bash">[ 3/ 3]  lib/redis/dump.rb</span></span><br><span class="line">Installing ri documentation for redis-dump-0.4.0</span><br><span class="line">Parsing documentation for uri-redis-0.4.2</span><br><span class="line">Parsing sources...</span><br><span class="line"><span class="meta prompt_">100% </span><span class="language-bash">[ 3/ 3]  lib/uri/redis.rb</span></span><br><span class="line">Installing ri documentation for uri-redis-0.4.2</span><br><span class="line">Parsing documentation for yajl-ruby-1.4.0</span><br><span class="line">Parsing sources...</span><br><span class="line"><span class="meta prompt_">100% </span><span class="language-bash">[16/16]  lib/yajl/yajl.so</span></span><br><span class="line">Installing ri documentation for yajl-ruby-1.4.0</span><br><span class="line">Done installing documentation for drydock, redis, redis-dump, uri-redis, yajl-ruby after 1 seconds</span><br><span class="line">5 gems installed</span><br></pre></td></tr></tbody></table></figure>
</body></html>
              </div>
              <footer class="article-footer">
                <time class="article-footer-updated" datetime="2025-10-22T08:49:33.404Z" itemprop="dateModified">Last updated: 2025-10-22</time>
                <a href="/database/mysql/index.html" class="article-footer-next" title="概览"><span>Next</span><i class="fa fa-chevron-right"></i></a>
              </footer>
              
            </div>
          </div>
          <aside id="article-toc" role="navigation">
            <div id="article-toc-inner">
              <div id="carbonads" class="carbonads" style="text-align:center;font-family:'Noto Sans SC',sans-serif;">
  <span class="carbon-wrap">
    <a href="https://github.com/booboowei"
       class="carbon-img"
       target="_blank"
       rel="noopener sponsored">
      <img
        src="https://avatars2.githubusercontent.com/u/21328020?s=460&u=88cf6127c32932188f936d05636b7b0d36783ee1&v=4"
        alt="ads via Carbon"
        border="0"
        style="width:80px;height:80px;border-radius:50%;max-width:130px;"
      />
    </a>
    <a href="/about/"
       class="carbon-text"
       target="_blank"
       rel="noopener sponsored"
       style="display:block;margin-top:4px;">
      欢迎光临
    </a>
  </span>

  <!-- 日期显示 -->
  <div id="today-date" style="margin-top:12px;background:#f5f5f5;border-radius:12px;padding:10px 0;">
    <div id="weekday" style="font-size:14px;color:#555;"></div>
    <div id="day" style="font-size:36px;font-weight:bold;color:#000;"></div>
    <div id="ym" style="font-size:14px;color:#555;"></div>
    <div id="lunar" style="font-size:13px;color:#888;margin-top:4px;"></div>
  </div>

<script>
(function(){
  const now = new Date();
  const weekdays = ["星期日","星期一","星期二","星期三","星期四","星期五","星期六"];
  const year = now.getFullYear();
  const month = now.getMonth() + 1;
  const day = now.getDate();

  function toChineseNumber(num) {
    const map = {0:'〇',1:'一',2:'二',3:'三',4:'四',5:'五',6:'六',7:'七',8:'八',9:'九'};
    return String(num).split('').map(n=>map[n]).join('');
  }

  // 优先使用 Intl (现代浏览器支持农历/中国传统历)
  function getLunarByIntl(date) {
    try {
      // 获取农历的月（长格式，如 "九月" 或 "闰八月"），和日（数字）
      const monthFormatter = new Intl.DateTimeFormat('zh-CN-u-ca-chinese', { month: 'long' });
      const dayFormatter = new Intl.DateTimeFormat('zh-CN-u-ca-chinese', { day: 'numeric' });
      const lunarMonthText = monthFormatter.format(date); // 例如 "九月" 或 "闰八月"
      const lunarDayText = dayFormatter.format(date);     // 例如 "三十" 或 "初一"
      // 有的浏览器返回的 month 会包含 "闰" 字样，也可能返回汉字月份，需要适配
      return `农历${lunarMonthText}${lunarDayText}`;
    } catch (e) {
      return null; // 表示不支持 Intl 农历
    }
  }

  // 回退：简易本地农历算法（仅作兼容，适用于1900-2049范围）
  const lunarInfo = [0x04bd8,0x04ae0,0x0a570,0x054d5,0x0d260,0x0d950,0x16554,0x056a0,0x09ad0,0x055d2,
                     0x04ae0,0x0a5b6,0x0a4d0,0x0d250,0x1d255,0x0b540,0x0d6a0,0x0ada2,0x095b0,0x14977,
                     0x04970,0x0a4b0,0x0b4b5,0x06a50,0x06d40,0x1ab54,0x02b60,0x09570,0x052f2,0x04970,
                     0x06566,0x0d4a0,0x0ea50,0x06e95,0x05ad0,0x02b60,0x186e3,0x092e0,0x1c8d7,0x0c950,
                     0x0d4a0,0x1d8a6,0x0b550,0x056a0,0x1a5b4,0x025d0,0x092d0,0x0d2b2,0x0a950,0x0b557,
                     0x06ca0,0x0b550,0x15355,0x04da0,0x0a5b0,0x14573,0x052b0,0x0a9a8,0x0e950,0x06aa0,
                     0x0aea6,0x0ab50,0x04b60,0x0aae4,0x0a570,0x05260,0x0f263,0x0d950,0x05b57,0x056a0,
                     0x096d0,0x04dd5,0x04ad0,0x0a4d0,0x0d4d4,0x0d250,0x0d558,0x0b540,0x0b5a0,0x195a6,
                     0x095b0,0x049b0,0x0a974,0x0a4b0,0x0b27a,0x06a50,0x06d40,0x0af46,0x0ab60,0x09570,
                     0x04af5,0x04970,0x064b0,0x074a3,0x0ea50,0x06b58,0x05ac0,0x0ab60,0x096d5,0x092e0];

  function lYearDays(y){let i,sum=348;for(i=0x8000;i>0x8;i>>=1)sum+=(lunarInfo[y-1900]&i)?1:0;return sum+leapDays(y);}
  function leapDays(y){if(leapMonth(y))return(lunarInfo[y-1900]&0x10000)?30:29;else return 0;}
  function leapMonth(y){return lunarInfo[y-1900]&0xf;}
  function monthDays(y,m){return(lunarInfo[y-1900]&(0x10000>>m))?30:29;}

  function LunarFallback(objDate){
    let i, leap=0, temp=0;
    const baseDate = new Date(1900,0,31);
    let offset = Math.floor((objDate - baseDate) / 86400000);
    let year = 1900;
    // 年循环
    for (i = 1900; i < 2050 && offset > 0; i++) {
      temp = lYearDays(i);
      offset -= temp;
      year = i;
    }
    if (offset < 0) { offset += temp; year--; }
    leap = leapMonth(year);
    let isLeap = false;
    let month = 1;
    // 月循环
    for (i = 1; i <= 12 && offset > 0; i++) {
      if (leap > 0 && i === (leap + 1) && !isLeap) {
        // 进入闰月
        temp = leapDays(year);
        isLeap = true;
        i--; // stay on same month number but mark leap
      } else {
        temp = monthDays(year, i);
      }
      offset -= temp;
      if (isLeap && i === leap) { isLeap = false; }
      if (!isLeap) month++; // 非闰月时才推进月份计数
    }
    if (offset === 0 && leap > 0 && month === leap + 1) {
      // 特殊：当正好落在闰月第一天
      // month 保持，isLeap = true
    }
    if (offset < 0) { offset += temp; month--; }
    const day = offset + 1;
    // 修正 month 边界
    if (month <= 0) month = 1;
    return { year, month, day, isLeap: !!isLeap };
  }

  function getLunarDateStringFallback(y,m,d){
    const cDay=["","初一","初二","初三","初四","初五","初六","初七","初八","初九","初十",
                "十一","十二","十三","十四","十五","十六","十七","十八","十九","二十",
                "廿一","廿二","廿三","廿四","廿五","廿六","廿七","廿八","廿九","三十"];
    const cMon=["","正月","二月","三月","四月","五月","六月","七月","八月","九月","十月","冬月","腊月"];
    const lunar = LunarFallback(new Date(y, m-1, d));
    return `农历${lunar.isLeap ? '闰' : ''}${cMon[lunar.month]}${cDay[lunar.day]}`;
  }

  // 先尝试 Intl 方法
  let lunarText = getLunarByIntl(now);
  if (!lunarText) {
    // 回退本地算法
    lunarText = getLunarDateStringFallback(year, month, day);
  }

  // 输出到页面（公历 + 农历）
  document.getElementById("weekday").textContent = weekdays[now.getDay()];
  document.getElementById("day").textContent = day;
  document.getElementById("ym").textContent = `${toChineseNumber(year)}年${toChineseNumber(month)}月`;
  document.getElementById("lunar").textContent = lunarText;
})();
</script>


              <strong class="sidebar-title">Contents</strong>
              <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Redis-%E5%86%85%E5%AD%98%E4%BD%BF%E7%94%A8%E7%8E%87%E5%81%8F%E9%AB%98"><span class="toc-text">Redis 内存使用率偏高</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E5%8E%9F%E5%9B%A0"><span class="toc-text">问题原因</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E5%BB%BA%E8%AE%AE"><span class="toc-text">解决建议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%AE%E5%8A%A9%E6%96%87%E6%A1%A3"><span class="toc-text">帮助文档</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%89%B9%E9%87%8F%E5%88%A0%E9%99%A4redis%E7%9A%84key"><span class="toc-text">批量删除redis的key</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9C%80%E6%B1%82"><span class="toc-text">需求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95"><span class="toc-text">解决方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%9D%E8%B7%AF"><span class="toc-text">思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B7%E4%BD%93%E6%93%8D%E4%BD%9C"><span class="toc-text">具体操作</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Redis-%E8%BF%81%E7%A7%BB%E5%90%88%E5%B9%B6"><span class="toc-text">Redis 迁移合并</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9C%80%E6%B1%82-1"><span class="toc-text">需求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B0%83%E7%A0%94%E6%83%85%E5%86%B5"><span class="toc-text">调研情况</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%81%E7%A7%BB%E6%95%B0%E6%8D%AE"><span class="toc-text">迁移数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-1"><span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Redis-%E5%B8%B8%E8%A7%81%E6%8A%A5%E9%94%99%E8%A7%A3%E5%86%B3"><span class="toc-text">Redis 常见报错解决</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#RDB%E5%A4%B1%E8%B4%A5%E4%BB%A5%E5%8F%8AAOF%E6%96%87%E4%BB%B6%E5%BC%82%E5%B8%B8%E5%A4%A7"><span class="toc-text">RDB失败以及AOF文件异常大</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%A5%E9%94%99%E5%8E%9F%E5%9B%A0"><span class="toc-text">报错原因</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E5%9B%A0%E5%92%8C%E8%A7%A3%E5%86%B3"><span class="toc-text">原因和解决</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISCONF"><span class="toc-text">MISCONF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%A5%E9%94%99%E6%98%8E%E7%BB%86"><span class="toc-text">报错明细</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E5%9B%A0%E5%92%8C%E8%A7%A3%E5%86%B3-1"><span class="toc-text">原因和解决</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#centos6-5-%E5%AE%89%E8%A3%85ruby-2-3-1"><span class="toc-text">centos6.5 安装ruby 2.3.1</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A4%E6%A6%82%E8%A7%88"><span class="toc-text">步骤概览</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E6%98%8E%E7%BB%86"><span class="toc-text">操作明细</span></a></li></ol></li></ol>
              <a href="#" id="article-toc-top">Back to Top</a>
            </div>
          </aside>
        </div>
      </article>
      <aside id="sidebar" role="navigation">
  <div class="inner">
    <strong class="sidebar-title">MySQL</strong><a href="/database/mysql/index.html" class="sidebar-link">概览</a><a href="/database/mysql/booboo_mysql/index.html" class="sidebar-link">MySQL 基础</a><a href="/database/mysql/dba_mysql/index.html" class="sidebar-link">MySQL 运维实践</a><a href="/database/mysql/rds_mysql/index.html" class="sidebar-link">RDS 性能调优</a><a href="/database/mysql/security/index.html" class="sidebar-link">安全篇</a><a href="/database/mysql/awesome-tools/index.html" class="sidebar-link">工具篇</a><strong class="sidebar-title">Oracle</strong><a href="/database/oracle/index.html" class="sidebar-link">概览</a><a href="/database/oracle/ocp/index.html" class="sidebar-link">Oracle12C OCP</a><a href="/database/oracle/oracle-12c/index.html" class="sidebar-link">Oracle 12c 学习笔记</a><a href="/database/oracle/oracle-11g/index.html" class="sidebar-link">Oracle 11g 学习笔记</a><strong class="sidebar-title">NoSQL</strong><a href="/database/nosql/index.html" class="sidebar-link">概览</a><a href="/database/nosql/booboo_redis/index.html" class="sidebar-link">Redis 基础</a><a href="/database/nosql/dba_redis/index.html" class="sidebar-link">Redis 进阶</a><a href="/database/nosql/booboo_mongodb/index.html" class="sidebar-link">MongoDB 基础</a><a href="/database/nosql/hadoop/index.html" class="sidebar-link">Hadoop 基础</a><strong class="sidebar-title">TiDB</strong><a href="/database/tidb/index.html" class="sidebar-link">概览</a><a href="/database/tidb/00_tidb入门指南.html" class="sidebar-link">TiDB 入门指南</a><a href="/database/tidb/01_raft协议理解.html" class="sidebar-link">Raft协议理解</a><a href="/database/tidb/tidb_courses/index.html" class="sidebar-link">TiDB 21天课程</a>
  </div>
</aside>
    </div>
  </div>
</div>

    <footer id="footer" class="wrapper">
  <div class="inner">
    <div id="footer-copyright">
      &copy; 2025 <a href="https://github.com/BoobooWei" target="_blank">魏亚萍</a><br>
      Documentation licensed under <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank">CC BY 4.0</a>.<br>
      备案号：沪ICP备2020026043号
    </div>
    <div id="footer-links">
      <a href="https://www.youtube.com/@amyreading2023" class="footer-link" target="_blank">
        <img src="https://upload.wikimedia.org/wikipedia/commons/b/b8/YouTube_Logo_2017.svg" 
            alt="YouTube"
            style="height:24px; margin-bottom:-6px;">
      </a>
      <a href="https://github.com/BoobooWei" class="footer-link" target="_blank"><i class="fa fa-github-alt"></i></a>
    </div>
  </div>
</footer>

  </div>
  <div id="mobile-nav-dimmer"></div>
  <nav id="mobile-nav">
  <div id="mobile-nav-inner">
    <ul id="mobile-nav-list">
      <a href="../../../docs/" class="mobile-nav-link">Hexo</a><a href="../../../news/" class="mobile-nav-link">News</a><a href="../../../api/" class="mobile-nav-link">MySQL8.0</a><a href="../../../database/" class="mobile-nav-link">Database</a><a href="../../../linux/" class="mobile-nav-link">Linux</a><a href="../../../cloud/" class="mobile-nav-link">Cloud</a><a href="../../../singapore/" class="mobile-nav-link">Singapore</a><a href="../../../amy/" class="mobile-nav-link">AMY</a><a href="../../../about/" class="mobile-nav-link">About</a>
      <li class="mobile-nav-item">
        <a href="https://github.com/BoobooWei" class="mobile-nav-link" rel="external" target="_blank">GitHub</a>
      </li>
    </ul>
    
      <strong class="mobile-nav-title">MySQL</strong><a href="/database/mysql/index.html" class="mobile-nav-link">概览</a><a href="/database/mysql/booboo_mysql/index.html" class="mobile-nav-link">MySQL 基础</a><a href="/database/mysql/dba_mysql/index.html" class="mobile-nav-link">MySQL 运维实践</a><a href="/database/mysql/rds_mysql/index.html" class="mobile-nav-link">RDS 性能调优</a><a href="/database/mysql/security/index.html" class="mobile-nav-link">安全篇</a><a href="/database/mysql/awesome-tools/index.html" class="mobile-nav-link">工具篇</a><strong class="mobile-nav-title">Oracle</strong><a href="/database/oracle/index.html" class="mobile-nav-link">概览</a><a href="/database/oracle/ocp/index.html" class="mobile-nav-link">Oracle12C OCP</a><a href="/database/oracle/oracle-12c/index.html" class="mobile-nav-link">Oracle 12c 学习笔记</a><a href="/database/oracle/oracle-11g/index.html" class="mobile-nav-link">Oracle 11g 学习笔记</a><strong class="mobile-nav-title">NoSQL</strong><a href="/database/nosql/index.html" class="mobile-nav-link">概览</a><a href="/database/nosql/booboo_redis/index.html" class="mobile-nav-link">Redis 基础</a><a href="/database/nosql/dba_redis/index.html" class="mobile-nav-link">Redis 进阶</a><a href="/database/nosql/booboo_mongodb/index.html" class="mobile-nav-link">MongoDB 基础</a><a href="/database/nosql/hadoop/index.html" class="mobile-nav-link">Hadoop 基础</a><strong class="mobile-nav-title">TiDB</strong><a href="/database/tidb/index.html" class="mobile-nav-link">概览</a><a href="/database/tidb/00_tidb入门指南.html" class="mobile-nav-link">TiDB 入门指南</a><a href="/database/tidb/01_raft协议理解.html" class="mobile-nav-link">Raft协议理解</a><a href="/database/tidb/tidb_courses/index.html" class="mobile-nav-link">TiDB 21天课程</a>
    
  </div>
  <div id="mobile-lang-select-wrap">
    <span id="mobile-lang-select-label"><i class="fa fa-globe"></i><span>English</span></span>
    <select id="mobile-lang-select" data-canonical="">
      
        <option value="en" selected>English</option>
      
    </select>
  </div>
</nav>
  <!-- Scripts -->
<!-- Cookie -->
<script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>
<!-- build:js build/js/main.js -->

<script src="../../../js/lang_select.js"></script>


<script src="../../../js/mobile_nav.js"></script>

<!-- endbuild -->

<!-- Algolia -->
<!--   backup
<script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
<script type="text/javascript">
docsearch({
  appId: '',
  apiKey: '',
  indexName: '',
  insights: true,
  container: '#docsearch',
  debug: false,
  searchParameters: {
    facetFilters: ['lang:en']
  }
});
</script>
-->

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script type="text/javascript">
document.getElementById('search-input-wrap').classList.add('on');
docsearch({
    apiKey: '',
    indexName: '',
    inputSelector: '#search-input'
});
</script>
</body>
</html>