<!DOCTYPE html>
<html lang="en">
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8">
  <title>Linux文件系统和磁盘管理 | BoobooWei</title>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Canonical links -->
  <link rel="canonical" href="http://www.toberoot.com/linux/0_linux_base/booboo_linux_base/09-Linux%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%92%8C%E7%A3%81%E7%9B%98%E7%AE%A1%E7%90%86">
  <!-- Alternate links -->
  
    
      
    
    <link rel="alternate" hreflang="x-default" href="http://www.toberoot.com/linux/0_linux_base/booboo_linux_base/09-Linux%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%92%8C%E7%A3%81%E7%9B%98%E7%AE%A1%E7%90%86" />
  
  <!-- Icon -->
  <link rel="apple-touch-icon" sizes="57x57" href="../../../icon/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="114x114" href="../../../icon/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="72x72" href="../../../icon/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="144x144" href="../../../icon/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="60x60" href="../../../icon/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="120x120" href="../../../icon/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="76x76" href="../../../icon/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="152x152" href="../../../icon/apple-touch-icon-152x152.png">
  <link rel="icon" type="image/png" href="../../../icon/favicon-196x196.png" sizes="196x196">
  <link rel="icon" type="image/png" href="../../../icon/favicon-160x160.png" sizes="160x160">
  <link rel="icon" type="image/png" href="../../../icon/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="../../../icon/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="../../../icon/favicon-32x32.png" sizes="32x32">
  <meta name="msapplication-TileColor" content="#2f83cd">
  <meta name="msapplication-TileImage" content="../../../icon/mstile-144x144.png">
  <!-- CSS -->
  <!-- build:css build/css/navy.css -->
  
<link rel="stylesheet" href="../../../css/navy.css">

  <!-- endbuild -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-lato@0.0.75/index.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.3.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css">
  <!-- RSS -->
  <link rel="alternate" href="../../../atom.xml" title="BoobooWei" type="application/atom+xml">
  <!-- Open Graph -->
  <meta name="description" content="文件系统资源虚拟化 Linux操作系统内核由6个部分组成：  进程调度与管理 主存管理和虚存管理 VFS和文件管理 设备管理 网络接口和通信 用来实现资源抽象 资源分配和资源共享等功能。  文件系统的概念操作系统中负责管理和存储文件信息的软件机构称为文件管理系统，简称文件系统。 从系统角度来看，文件系统是对文件存储设备的空间进行组织和分配，负责文件存储并对存入的文件进行保护和检索的系统。 具体地说">
<meta property="og:type" content="website">
<meta property="og:title" content="Linux文件系统和磁盘管理">
<meta property="og:url" content="http://www.toberoot.com/linux/0_linux_base/booboo_linux_base/09-Linux%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%92%8C%E7%A3%81%E7%9B%98%E7%AE%A1%E7%90%86">
<meta property="og:site_name" content="BoobooWei">
<meta property="og:description" content="文件系统资源虚拟化 Linux操作系统内核由6个部分组成：  进程调度与管理 主存管理和虚存管理 VFS和文件管理 设备管理 网络接口和通信 用来实现资源抽象 资源分配和资源共享等功能。  文件系统的概念操作系统中负责管理和存储文件信息的软件机构称为文件管理系统，简称文件系统。 从系统角度来看，文件系统是对文件存储设备的空间进行组织和分配，负责文件存储并对存入的文件进行保护和检索的系统。 具体地说">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://www.toberoot.com/icon/og-image-wide.png">
<meta property="article:published_time" content="2025-10-22T08:53:56.017Z">
<meta property="article:modified_time" content="2025-10-22T08:48:51.544Z">
<meta property="article:author" content="魏亚萍">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.toberoot.com/icon/twitter-summary.png">
<meta property="fb:admins" content="100000247608790">
  <!-- Google Analytics -->
  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-48498357-3', 'auto');
  ga('send', 'pageview');
</script>

  <!-- Algolia -->
  <link rel="preconnect" href="https://-dsn.algolia.net" crossorigin />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3">
<meta name="generator" content="Hexo 8.0.0"></head>

<body>
  <div id="container">
    <header id="header" class="wrapper">
  <div id="header-inner" class="inner">
    <h1 id="logo-wrap">
      <a href="../../../" id="logo">Hexo</a>
    </h1>
    <nav id="main-nav">
      <a href="../../../docs/" class="main-nav-link">Hexo</a><a href="../../../news/" class="main-nav-link">News</a><a href="../../../api/" class="main-nav-link">MySQL8.0</a><a href="../../../database/" class="main-nav-link">Database</a><a href="../../../linux/" class="main-nav-link">Linux</a><a href="../../../cloud/" class="main-nav-link">Cloud</a><a href="../../../singapore/" class="main-nav-link">Singapore</a><a href="../../../amy/" class="main-nav-link">AMY</a><a href="../../../about/" class="main-nav-link">About</a>
      <a target="_blank" rel="noopener" href="https://github.com/BoobooWei" class="main-nav-link"><i class="fa fa-github-alt"></i></a>

      <div id="search-input-wrap">
        <div id="search-input-icon">
          <i class="fa fa-search"></i>
        </div>
        <input type="search" id="search-input" placeholder="Search...">
      </div>
    </nav>
    <div id="lang-select-wrap">
        <a href="/about/" class="main-nav-link"><label id="lang-select-label"><i class="fa fa-globe"></i><span>关于我</span></label></a>
    </div>
    <a id="mobile-nav-toggle">
      <span class="mobile-nav-toggle-bar"></span>
      <span class="mobile-nav-toggle-bar"></span>
      <span class="mobile-nav-toggle-bar"></span>
    </a>
  </div>
</header>

    <div id="content-wrap">
  <div id="content" class="wrapper">
    <div id="content-inner">
      <article class="article-container" itemscope itemtype="http://schema.org/Article">
        <div class="article-inner">
          <div class="article">
            <div class="inner">
              <header class="article-header">
                <h1 class="article-title" itemprop="name">Linux文件系统和磁盘管理</h1>
                <a target="_blank" rel="noopener" href="https://github.com/BoobooWei/site/edit/master/source/linux/0_linux_base/booboo_linux_base/09-Linux文件系统和磁盘管理.md" class="article-edit-link" title="Improve this doc"><i class="fa fa-pencil"></i></a>
              </header>
              <div class="article-content" itemprop="articleBody">
                <html><head></head><body><h2 id="文件系统" class="article-heading"><a href="#文件系统" class="headerlink" title="文件系统"></a>文件系统<a class="article-anchor" href="#文件系统" aria-hidden="true"></a></h2><h3 id="资源虚拟化" class="article-heading"><a href="#资源虚拟化" class="headerlink" title="资源虚拟化"></a>资源虚拟化<a class="article-anchor" href="#资源虚拟化" aria-hidden="true"></a></h3><p><img src="pic/20.png" alt="20"></p>
<p>Linux操作系统内核由6个部分组成：</p>
<ul>
<li>进程调度与管理</li>
<li>主存管理和虚存管理</li>
<li>VFS和文件管理</li>
<li>设备管理</li>
<li>网络接口和通信</li>
<li>用来实现资源抽象</li>
<li>资源分配和资源共享等功能。</li>
</ul>
<h3 id="文件系统的概念" class="article-heading"><a href="#文件系统的概念" class="headerlink" title="文件系统的概念"></a>文件系统的概念<a class="article-anchor" href="#文件系统的概念" aria-hidden="true"></a></h3><p>操作系统中负责管理和存储文件信息的软件机构称为文件管理系统，简称文件系统。</p>
<p>从系统角度来看，文件系统是对文件存储设备的空间进行组织和分配，负责文件存储并对存入的文件进行保护和检索的系统。</p>
<p>具体地说，它负责为用户建立文件，存入、读出、修改、转储文件，控制文件的存取，当用户不再使用时撤销文件等。</p>
<h3 id="文件系统的类型" class="article-heading"><a href="#文件系统的类型" class="headerlink" title="文件系统的类型"></a>文件系统的类型<a class="article-anchor" href="#文件系统的类型" aria-hidden="true"></a></h3><p>查看系统支持的文件系统<br><code>ls /lib/modules/$(uname -r)/kernel/fs </code></p>
<p>系统目前已加载到内存中支持的文件系统<br><code>more /proc/filesystems</code></p>
<h3 id="文件系统的结构" class="article-heading"><a href="#文件系统的结构" class="headerlink" title="文件系统的结构"></a>文件系统的结构<a class="article-anchor" href="#文件系统的结构" aria-hidden="true"></a></h3><p>索引式文件系统(indexed allocation)</p>
<p><img src="pic/21.png" alt="21"></p>
<p>文件系统内的信息主要有:</p>
<ul>
<li>superblock:记录filesystem的整体信息,包括 inode/block的总量、使用量、剩余量, 以及文件系统的格式等;</li>
<li>inode:记录文件属性,一个文件占一个inode,同时记录该文件数据所在的block 号码;</li>
<li>block:实际记录文件的内容,若档案太大时,会占用多个 block</li>
</ul>
<h3 id="文件系统的区别" class="article-heading"><a href="#文件系统的区别" class="headerlink" title="文件系统的区别"></a>文件系统的区别<a class="article-anchor" href="#文件系统的区别" aria-hidden="true"></a></h3><p>rhel6</p>
<figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line">[root@rhel6 ~]# mkfs</span><br><span class="line">mkfs          mkfs.ext2     mkfs.ext4     mkfs.msdos</span><br><span class="line">mkfs.cramfs   mkfs.ext3     mkfs.ext4dev  mkfs.vfat</span><br></pre></td></tr></tbody></table></figure>

<p>rhel7</p>
<figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line">[root@rhel7 ~]# mkfs</span><br><span class="line">mkfs         mkfs.cramfs  mkfs.ext3    mkfs.fat     mkfs.msdos   mkfs.xfs</span><br><span class="line">mkfs.btrfs   mkfs.ext2    mkfs.ext4    mkfs.minix   mkfs.vfat</span><br></pre></td></tr></tbody></table></figure>

<p>EXT4 Linux kernel 自 2.6.28 开始正式支持新的文件系统 Ext4。Ext4 是 Ext3 的改进版，修改了 Ext3 中部分重要的数据结构，而不仅仅像 Ext3 对 Ext2 那样，只是增加了一个日志功能而已。Ext4 可以提供更佳的性能和可靠性，还有更为丰富的功能，不向下兼容ext3。</p>
<p>XFS 针对海量小文件的存储及超大文件的存储有一些有时,但 EXT 系统相对稳定。XFS 是 Silicon Graphics，Inc. 于 90 年代初开发的文件系统。它至今仍作为 SGI 基于 IRIX 的产品（从工作站到超级计算机）的底层文件系统来使用。现在，XFS 也可以用于 Linux。XFS 的 Linux 版的到来是激动人心的，首先因为它为 Linux 社区提供了一种健壮的、优秀的以及功能丰富的文件系统，并且这种文件系统所具有的可伸缩性能够满足最苛刻的存储需求。</p>
<h3 id="文件系统的简单操作" class="article-heading"><a href="#文件系统的简单操作" class="headerlink" title="文件系统的简单操作"></a>文件系统的简单操作<a class="article-anchor" href="#文件系统的简单操作" aria-hidden="true"></a></h3><p><img src="pic/22.png" alt="22"></p>
<h4 id="df" class="article-heading"><a href="#df" class="headerlink" title="df"></a>df<a class="article-anchor" href="#df" aria-hidden="true"></a></h4><p><img src="pic/23.png" alt="23"></p>
<p>实例：</p>
<ol>
<li>使用-h选项以KB以上的单位来显示，可读性高</li>
</ol>
<figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta prompt_">[#</span><span class="language-bash">3#root@rhel6 ~]#<span class="built_in">df</span> -h</span></span><br><span class="line">Filesystem                     Size  Used Avail Use% Mounted on</span><br><span class="line">/dev/mapper/vg_rhel6-LogVol01   17G  3.0G   13G  19% /</span><br><span class="line">tmpfs                          499M   72K  499M   1% /dev/shm</span><br><span class="line">/dev/vda1                      477M   58M  390M  13% /boot</span><br><span class="line">/dev/mapper/vg_rhel6-LogVol00  380M  2.3M  354M   1% /home</span><br></pre></td></tr></tbody></table></figure>

<ol start="2">
<li>查看全部文件系统：</li>
</ol>
<figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta prompt_">[#</span><span class="language-bash">4#root@rhel6 ~]#<span class="built_in">df</span> -a</span></span><br><span class="line">Filesystem                    1K-blocks    Used Available Use% Mounted on</span><br><span class="line">/dev/mapper/vg_rhel6-LogVol01  17535796 3127044  13494936  19% /</span><br><span class="line">proc                                  0       0         0    - /proc</span><br><span class="line">sysfs                                 0       0         0    - /sys</span><br><span class="line">devpts                                0       0         0    - /dev/pts</span><br><span class="line">tmpfs                            510368      72    510296   1% /dev/shm</span><br><span class="line">/dev/vda1                        487652   58631    399325  13% /boot</span><br><span class="line">/dev/mapper/vg_rhel6-LogVol00    388480    2335    361569   1% /home</span><br><span class="line">none                                  0       0         0    - /proc/sys/fs/binfmt_misc</span><br></pre></td></tr></tbody></table></figure>

<h4 id="du" class="article-heading"><a href="#du" class="headerlink" title="du"></a>du<a class="article-anchor" href="#du" aria-hidden="true"></a></h4><p><img src="pic/24.png" alt="24"></p>
<p>实例：</p>
<ol>
<li>查看指定目录所占空间</li>
</ol>
<figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta prompt_">[#</span><span class="language-bash">9#root@rhel6 ~]#<span class="built_in">du</span> -s /var/</span></span><br><span class="line">140252	/var/</span><br><span class="line"><span class="meta prompt_">[#</span><span class="language-bash">10#root@rhel6 ~]#<span class="built_in">du</span> -sh /var/</span></span><br><span class="line">137M	/var/</span><br></pre></td></tr></tbody></table></figure>

<ol start="2">
<li>查看指定目录下的所有文件，包括隐藏文件</li>
</ol>
<figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta prompt_">[#</span><span class="language-bash">16#root@rhel6 ~]#<span class="built_in">du</span> -h /tmp</span></span><br><span class="line">8.0K	/tmp/pulse-oCBy0hGD1JT6</span><br><span class="line">4.0K	/tmp/.X11-unix</span><br><span class="line">4.0K	/tmp/.esd-0</span><br><span class="line">4.0K	/tmp/virtual-root.JyC7Qb</span><br><span class="line">8.0K	/tmp/orbit-gdm</span><br><span class="line">4.0K	/tmp/.ICE-unix</span><br><span class="line">8.0K	/tmp/pulse-q5sECpImz7Ju</span><br><span class="line">48K	/tmp</span><br><span class="line"><span class="meta prompt_">[#</span><span class="language-bash">15#root@rhel6 ~]#<span class="built_in">du</span> -ha /tmp</span></span><br><span class="line">4.0K	/tmp/pulse-oCBy0hGD1JT6/pid</span><br><span class="line">0	/tmp/pulse-oCBy0hGD1JT6/native</span><br><span class="line">8.0K	/tmp/pulse-oCBy0hGD1JT6</span><br><span class="line">0	/tmp/.X11-unix/X0</span><br><span class="line">4.0K	/tmp/.X11-unix</span><br><span class="line">0	/tmp/.esd-0/socket</span><br><span class="line">4.0K	/tmp/.esd-0</span><br><span class="line">4.0K	/tmp/virtual-root.JyC7Qb</span><br><span class="line">4.0K	/tmp/.X0-lock</span><br><span class="line">0	/tmp/orbit-gdm/linc-6c2-0-7846478690c68</span><br><span class="line">0	/tmp/orbit-gdm/bonobo-activation-register-75c59b1ecf3edd6ad04cfcfd00000056.lock</span><br><span class="line">4.0K	/tmp/orbit-gdm/bonobo-activation-server-75c59b1ecf3edd6ad04cfcfd00000056-ior</span><br><span class="line">0	/tmp/orbit-gdm/linc-6e5-0-3bda60586d2f0</span><br><span class="line">0	/tmp/orbit-gdm/linc-6bb-0-2bf2fd0bb015c</span><br><span class="line">0	/tmp/orbit-gdm/linc-6e1-0-44f3459db98f9</span><br><span class="line">0	/tmp/orbit-gdm/linc-6d9-0-26db8cdee8dec</span><br><span class="line">0	/tmp/orbit-gdm/linc-6e0-0-7f7b8d4664593</span><br><span class="line">0	/tmp/orbit-gdm/linc-6e4-0-540f978681aee</span><br><span class="line">0	/tmp/orbit-gdm/linc-6d4-0-3a04cbe9566</span><br><span class="line">0	/tmp/orbit-gdm/linc-6d5-0-75caf0f81ab48</span><br><span class="line">8.0K	/tmp/orbit-gdm</span><br><span class="line">0	/tmp/.ICE-unix/1723</span><br><span class="line">4.0K	/tmp/.ICE-unix</span><br><span class="line">4.0K	/tmp/pulse-q5sECpImz7Ju/pid</span><br><span class="line">0	/tmp/pulse-q5sECpImz7Ju/native</span><br><span class="line">8.0K	/tmp/pulse-q5sECpImz7Ju</span><br><span class="line">48K	/tmp</span><br></pre></td></tr></tbody></table></figure>

<h2 id="磁盘的分割、格式化与挂载" class="article-heading"><a href="#磁盘的分割、格式化与挂载" class="headerlink" title="磁盘的分割、格式化与挂载"></a>磁盘的分割、格式化与挂载<a class="article-anchor" href="#磁盘的分割、格式化与挂载" aria-hidden="true"></a></h2><p>新增一颗硬盘时 , 该怎么做 :</p>
<ol>
<li>对磁盘进行分割 , 以建立可用的分区 partition ; <fdisk></fdisk></li>
<li>对该 partition 进行格式化 ( format ), 以建立系统可用的文件系统 filesystem;<mkfs></mkfs></li>
<li>若想要仔细一点 , 则可对刚刚建立好的 filesystem 进行检验 ;&lt;fsck, badblocks&gt;</li>
<li>在 Linux 系统上 , 需要建立挂载点 ( 目录 ), 并将他挂载上来。 <mount></mount></li>
<li>如果 ll /dev/ 新建的分区不存在,则使用 partx -a /dev/vdb 让新建的分区被读取生效,或者重启电脑</li>
</ol>
<h3 id="分割-fdisk" class="article-heading"><a href="#分割-fdisk" class="headerlink" title="分割 fdisk"></a>分割 fdisk<a class="article-anchor" href="#分割-fdisk" aria-hidden="true"></a></h3><p>fdisk命令用于观察硬盘实体使用情况，也可对硬盘分区。它采用传统的问答式界面。</p>
<p>语法 fdisk(选项)(参数)</p>
<p>选项</p>
<ul>
<li>-b&lt;分区大小&gt;：指定每个分区的大小；</li>
<li>-l：列出指定的外围设备的分区表状况；</li>
<li>-s&lt;分区编号&gt;：将指定的分区大小输出到标准输出上，单位为区块；</li>
<li>-u：搭配”-l”参数列表，会用分区数目取代柱面数目，来表示每个分区的起始地址；</li>
<li>-v：显示版本信息。</li>
</ul>
<p>参数 设备文件：指定要进行分区或者显示分区的硬盘设备文件。</p>
<figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta prompt_">[#</span><span class="language-bash">20#root@rhel6 ~]#fdisk -l</span></span><br><span class="line"></span><br><span class="line">Disk /dev/vda: 21.5 GB, 21474836480 bytes</span><br><span class="line">16 heads, 63 sectors/track, 41610 cylinders</span><br><span class="line">Units = cylinders of 1008 * 512 = 516096 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disk identifier: 0x000d166b</span><br><span class="line"></span><br><span class="line">   Device Boot      Start         End      Blocks   Id  System</span><br><span class="line">/dev/vda1   *           3        1018      512000   83  Linux</span><br><span class="line">Partition 1 does not end on cylinder boundary.</span><br><span class="line">/dev/vda2            1018        5179     2097152   82  Linux swap / Solaris</span><br><span class="line">Partition 2 does not end on cylinder boundary.</span><br><span class="line">/dev/vda3            5179       41611    18361344   8e  Linux LVM</span><br><span class="line">Partition 3 does not end on cylinder boundary.</span><br><span class="line"></span><br><span class="line">Disk /dev/vdb: 10.7 GB, 10737418240 bytes</span><br><span class="line">16 heads, 63 sectors/track, 20805 cylinders</span><br><span class="line">Units = cylinders of 1008 * 512 = 516096 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disk identifier: 0x00000000</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Disk /dev/mapper/vg_rhel6-LogVol01: 18.4 GB, 18379440128 bytes</span><br><span class="line">255 heads, 63 sectors/track, 2234 cylinders</span><br><span class="line">Units = cylinders of 16065 * 512 = 8225280 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disk identifier: 0x00000000</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Disk /dev/mapper/vg_rhel6-LogVol00: 419 MB, 419430400 bytes</span><br><span class="line">255 heads, 63 sectors/track, 50 cylinders</span><br><span class="line">Units = cylinders of 16065 * 512 = 8225280 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disk identifier: 0x00000000</span><br><span class="line"><span class="meta prompt_">[#</span><span class="language-bash">21#root@rhel6 ~]#fdisk /dev/vdb</span></span><br><span class="line">Device contains neither a valid DOS partition table, nor Sun, SGI or OSF disklabel</span><br><span class="line">Building a new DOS disklabel with disk identifier 0x23c41712.</span><br><span class="line">Changes will remain in memory only, until you decide to write them.</span><br><span class="line">After that, of course, the previous content won't be recoverable.</span><br><span class="line"></span><br><span class="line">Warning: invalid flag 0x0000 of partition table 4 will be corrected by w(rite)</span><br><span class="line"></span><br><span class="line">WARNING: DOS-compatible mode is deprecated. It's strongly recommended to</span><br><span class="line">         switch off the mode (command 'c') and change display units to</span><br><span class="line">         sectors (command 'u').</span><br><span class="line"></span><br><span class="line">Command (m for help): m &lt;== 输入 m 后 , 就会看到底下这些指令介绍</span><br><span class="line">Command action</span><br><span class="line">a toggle a bootable flag</span><br><span class="line">b edit bsd disklabel</span><br><span class="line">c toggle the dos compatibility flag</span><br><span class="line">d delete a partition &lt;== 删除一个分区</span><br><span class="line">l list known partition types</span><br><span class="line">m print this menu</span><br><span class="line">n add a new partition &lt;== 新增一个分区</span><br><span class="line">o create a new empty DOS partition table</span><br><span class="line">p print the partition table== 在屏幕上显示分割表</span><br><span class="line">q quit without saving changes&lt;== 不储存离开 fdisk 程序</span><br><span class="line">s create a new empty Sun disklabel</span><br><span class="line">t change a partition's system id</span><br><span class="line">u change display/entry units</span><br><span class="line">v verify the partition table</span><br><span class="line">w write table to disk and exit&lt;== 将刚刚的动作写入分割表</span><br><span class="line">x extra functionality (experts only)</span><br><span class="line">Command (m for help): p</span><br><span class="line"></span><br><span class="line">Disk /dev/vdb: 10.7 GB, 10737418240 bytes</span><br><span class="line">16 heads, 63 sectors/track, 20805 cylinders</span><br><span class="line">Units = cylinders of 1008 * 512 = 516096 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disk identifier: 0x23c41712</span><br><span class="line"></span><br><span class="line">   Device Boot      Start         End      Blocks   Id  System</span><br><span class="line"></span><br><span class="line">Command (m for help): n</span><br><span class="line">Command action</span><br><span class="line">   e   extended</span><br><span class="line">   p   primary partition (1-4)</span><br><span class="line">p</span><br><span class="line">Partition number (1-4): 1</span><br><span class="line">First cylinder (1-20805, default 1):</span><br><span class="line">Using default value 1</span><br><span class="line">Last cylinder, +cylinders or +size{K,M,G} (1-20805, default 20805):</span><br><span class="line">Using default value 20805</span><br><span class="line"></span><br><span class="line">Command (m for help): p</span><br><span class="line"></span><br><span class="line">Disk /dev/vdb: 10.7 GB, 10737418240 bytes</span><br><span class="line">16 heads, 63 sectors/track, 20805 cylinders</span><br><span class="line">Units = cylinders of 1008 * 512 = 516096 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disk identifier: 0x23c41712</span><br><span class="line"></span><br><span class="line">   Device Boot      Start         End      Blocks   Id  System</span><br><span class="line">/dev/vdb1               1       20805    10485688+  83  Linux</span><br><span class="line"></span><br><span class="line">Command (m for help): w</span><br><span class="line">The partition table has been altered!</span><br><span class="line"></span><br><span class="line">Calling ioctl() to re-read partition table.</span><br><span class="line">Syncing disks.</span><br><span class="line"><span class="meta prompt_">[#</span><span class="language-bash">22#root@rhel6 ~]#<span class="built_in">ls</span> /dev|grep vdb</span></span><br><span class="line">vdb</span><br><span class="line">vdb1</span><br><span class="line">[root@rhel7 ~]# fdisk /dev/vdb</span><br><span class="line">Welcome to fdisk (util-linux 2.23.2).</span><br><span class="line"></span><br><span class="line">Changes will remain in memory only, until you decide to write them.</span><br><span class="line">Be careful before using the write command.</span><br><span class="line"></span><br><span class="line">Device does not contain a recognized partition table</span><br><span class="line">Building a new DOS disklabel with disk identifier 0x8366bb08.</span><br><span class="line"></span><br><span class="line">Command (m for help): p</span><br><span class="line"></span><br><span class="line">Disk /dev/vdb: 10.7 GB, 10737418240 bytes, 20971520 sectors</span><br><span class="line">Units = sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disk label type: dos</span><br><span class="line">Disk identifier: 0x8366bb08</span><br><span class="line"></span><br><span class="line">   Device Boot      Start         End      Blocks   Id  System</span><br><span class="line"></span><br><span class="line">Command (m for help): n</span><br><span class="line">Partition type:</span><br><span class="line">   p   primary (0 primary, 0 extended, 4 free)</span><br><span class="line">   e   extended</span><br><span class="line">Select (default p): p</span><br><span class="line">Partition number (1-4, default 1): 1</span><br><span class="line">First sector (2048-20971519, default 2048):</span><br><span class="line">Using default value 2048</span><br><span class="line">Last sector, +sectors or +size{K,M,G} (2048-20971519, default 20971519):</span><br><span class="line">Using default value 20971519</span><br><span class="line">Partition 1 of type Linux and of size 10 GiB is set</span><br><span class="line"></span><br><span class="line">Command (m for help): p</span><br><span class="line"></span><br><span class="line">Disk /dev/vdb: 10.7 GB, 10737418240 bytes, 20971520 sectors</span><br><span class="line">Units = sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disk label type: dos</span><br><span class="line">Disk identifier: 0x8366bb08</span><br><span class="line"></span><br><span class="line">   Device Boot      Start         End      Blocks   Id  System</span><br><span class="line">/dev/vdb1            2048    20971519    10484736   83  Linux</span><br><span class="line"></span><br><span class="line">Command (m for help): w</span><br><span class="line">The partition table has been altered!</span><br><span class="line"></span><br><span class="line">Calling ioctl() to re-read partition table.</span><br><span class="line">Syncing disks.</span><br></pre></td></tr></tbody></table></figure>

<h3 id="磁盘格式化-mkfs" class="article-heading"><a href="#磁盘格式化-mkfs" class="headerlink" title="磁盘格式化 mkfs"></a>磁盘格式化 mkfs<a class="article-anchor" href="#磁盘格式化-mkfs" aria-hidden="true"></a></h3><p><img src="pic/25.png" alt="25"></p>
<ol>
<li>rhel6实例：查看支持的文件系统；将/dev/vdb1格式化成ext4文件系统</li>
</ol>
<figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta prompt_">[#</span><span class="language-bash">23#root@rhel6 ~]#mkfs</span></span><br><span class="line">mkfs          mkfs.cramfs   mkfs.ext2     mkfs.ext3     mkfs.ext4     mkfs.ext4dev  mkfs.msdos    mkfs.vfat</span><br><span class="line"><span class="meta prompt_">[#</span><span class="language-bash">24#root@rhel6 ~]#mkfs.ext4 /dev/vdb1</span></span><br><span class="line">mke2fs 1.41.12 (17-May-2010)</span><br><span class="line">Filesystem label=</span><br><span class="line">OS type: Linux</span><br><span class="line">Block size=4096 (log=2)</span><br><span class="line">Fragment size=4096 (log=2)</span><br><span class="line">Stride=0 blocks, Stripe width=0 blocks</span><br><span class="line">655360 inodes, 2621422 blocks</span><br><span class="line">131071 blocks (5.00%) reserved for the super user</span><br><span class="line">First data block=0</span><br><span class="line">Maximum filesystem blocks=2684354560</span><br><span class="line">80 block groups</span><br><span class="line">32768 blocks per group, 32768 fragments per group</span><br><span class="line">8192 inodes per group</span><br><span class="line">Superblock backups stored on blocks:</span><br><span class="line">	32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632</span><br><span class="line">Writing inode tables: done</span><br><span class="line">Creating journal (32768 blocks): done</span><br><span class="line">Writing superblocks and filesystem accounting information: done</span><br><span class="line">This filesystem will be automatically checked every 38 mounts or</span><br><span class="line">180 days, whichever comes first.  Use tune2fs -c or -i to override.</span><br></pre></td></tr></tbody></table></figure>

<ol start="2">
<li>rhel7实例：查看支持的文件系统；将/dev/vdb1格式化成xfs文件系统</li>
</ol>
<figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line">[root@rhel7 ~]# mkfs</span><br><span class="line">mkfs         mkfs.cramfs  mkfs.ext3    mkfs.fat     mkfs.msdos   mkfs.xfs</span><br><span class="line">mkfs.btrfs   mkfs.ext2    mkfs.ext4    mkfs.minix   mkfs.vfat</span><br><span class="line">[root@rhel7 ~]# mkfs.xfs /dev/vdb1</span><br><span class="line">meta-data=/dev/vdb1              isize=256    agcount=4, agsize=655296 blks</span><br><span class="line">         =                       sectsz=512   attr=2, projid32bit=1</span><br><span class="line">         =                       crc=0</span><br><span class="line">data     =                       bsize=4096   blocks=2621184, imaxpct=25</span><br><span class="line">         =                       sunit=0      swidth=0 blks</span><br><span class="line">naming   =version 2              bsize=4096   ascii-ci=0 ftype=0</span><br><span class="line">log      =internal log           bsize=4096   blocks=2560, version=2</span><br><span class="line">         =                       sectsz=512   sunit=0 blks, lazy-count=1</span><br><span class="line">realtime =none                   extsz=4096   blocks=0, rtextents=0</span><br></pre></td></tr></tbody></table></figure>

<h3 id="挂载" class="article-heading"><a href="#挂载" class="headerlink" title="挂载"></a>挂载<a class="article-anchor" href="#挂载" aria-hidden="true"></a></h3><p>/etc/fstab</p>
<p>/etc/filesystems: 系统指定的测试挂载文件系统类型 ;</p>
<p>/proc/filesystems:Linux 系统已经加载的文件系统类型。</p>
<h4 id="mount-的用法" class="article-heading"><a href="#mount-的用法" class="headerlink" title="mount 的用法"></a>mount 的用法<a class="article-anchor" href="#mount-的用法" aria-hidden="true"></a></h4><ol>
<li><p>标准用法 <code>mount -t ext4 /dev/vdb1 /mnt/vdb1 </code></p>
</li>
<li><p>远程挂载 <code>mount ip:/xx /xx</code></p>
<p><code>mount 172.25.254.250 : /content /mnt</code> &lt;== 远程挂载案例</p>
</li>
<li><p>其他选项:</p>
</li>
</ol>
<p>A.-o loop 挂载镜像文件</p>
<ul>
<li>用法: mount -o loop 被挂载的文件 挂载点</li>
<li>例如: mount -o loop rhel-server-6.5-x86_64-dvd.iso /test</li>
</ul>
<p>B.-o ro 以只读方式挂载</p>
<ul>
<li>用法: mount -o ro 被挂在的设备 挂载点</li>
<li>例如: mount -o ro /dev/vdb1 /test</li>
</ul>
<p>C.-o remount 重新挂载</p>
<ul>
<li><p>用法: mount -o remount 被挂载的设备 挂载点</p>
</li>
<li><p>例如: mount -o remount,rw,auto / &lt;== 重新挂载根目录</p>
<p>mount -o remount,ro newdir &lt;== 重新挂载为只读</p>
</li>
</ul>
<p>D.-t iso9660 挂载CD/DVD</p>
<ul>
<li>用法: mount -t iso9660 被挂载的设备 挂载点</li>
<li>例如: mount -t iso9660 /dev/dvdrom /media/dvdrom</li>
</ul>
<h4 id="mount-的查看" class="article-heading"><a href="#mount-的查看" class="headerlink" title="mount 的查看"></a>mount 的查看<a class="article-anchor" href="#mount-的查看" aria-hidden="true"></a></h4><p>df -h</p>
<p>mount &lt;== 查看设备和目录挂载点的关系</p>
<figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta prompt_">[#</span><span class="language-bash">27#root@rhel6 ~]#mount</span></span><br><span class="line">/dev/mapper/vg_rhel6-LogVol01 on / type ext4 (rw)</span><br><span class="line">proc on /proc type proc (rw)</span><br><span class="line">sysfs on /sys type sysfs (rw)</span><br><span class="line">devpts on /dev/pts type devpts (rw,gid=5,mode=620)</span><br><span class="line">tmpfs on /dev/shm type tmpfs (rw,rootcontext="system_u:object_r:tmpfs_t:s0")</span><br><span class="line">/dev/vda1 on /boot type ext4 (rw)</span><br><span class="line">/dev/mapper/vg_rhel6-LogVol00 on /home type ext4 (rw)</span><br><span class="line">none on /proc/sys/fs/binfmt_misc type binfmt_misc (rw)</span><br></pre></td></tr></tbody></table></figure>

<h4 id="umount" class="article-heading"><a href="#umount" class="headerlink" title="umount"></a>umount<a class="article-anchor" href="#umount" aria-hidden="true"></a></h4><p>umount [-fn] 设备文件名与挂载点</p>
<p>umount /mnt</p>
<p>注意事项:</p>
<ol>
<li>对某个挂载点使用多次 mount ,会把之前的内容隐藏起来,只能看到最后一次挂载的设备文件里的内容</li>
<li>不要在挂载点里面执行 umount 命令,会报错</li>
<li>尽量不要在挂载点里执行 mount 挂载命令</li>
<li>mount 命令为临时生效</li>
</ol>
<h3 id="etc-fstab-将永久生效" class="article-heading"><a href="#etc-fstab-将永久生效" class="headerlink" title="/etc/fstab 将永久生效"></a>/etc/fstab 将永久生效<a class="article-anchor" href="#etc-fstab-将永久生效" aria-hidden="true"></a></h3><p><img src="pic/26.png" alt="26"></p>
<p>是否需要检测:非 0 代表检测,数字越小优先级越高</p>
<p>修改后保存,通过 <code>mount -a </code>让配置生效</p>
<h2 id="磁盘配额-Quota" class="article-heading"><a href="#磁盘配额-Quota" class="headerlink" title="磁盘配额 Quota"></a>磁盘配额 Quota<a class="article-anchor" href="#磁盘配额-Quota" aria-hidden="true"></a></h2><p>如前面介绍章节讲到的类 Unix 系统最初设计理念就让许多人一起使用,多任务的操作系统,但是硬件的资源是固定有限 的,如果出现个小破坏份子不断的创建文件或下载电影,那么硬盘空间总有一天会被占满的吧,这时就需要 quota服务 帮助我们为每个用户限制可以使用的硬盘空间,一旦超出预算就不再允许他们使用。</p>
<h3 id="作用和分类" class="article-heading"><a href="#作用和分类" class="headerlink" title="作用和分类"></a>作用和分类<a class="article-anchor" href="#作用和分类" aria-hidden="true"></a></h3><p>quota 的磁盘配额可以限制用户的硬盘可用空间或最大创建文件数量,并且还有软/硬限制的区别:</p>
<ul>
<li>软限制:当达到软限制时会提示用户,但允许用户在规定期限内继续使用。</li>
<li>硬限制:当达到硬限制时会提示用户,且强制终止用户的操作。</li>
</ul>
<h3 id="相关命令" class="article-heading"><a href="#相关命令" class="headerlink" title="相关命令"></a>相关命令<a class="article-anchor" href="#相关命令" aria-hidden="true"></a></h3><h4 id="quotacheck" class="article-heading"><a href="#quotacheck" class="headerlink" title="quotacheck"></a>quotacheck<a class="article-anchor" href="#quotacheck" aria-hidden="true"></a></h4><p>quotacheck命令通过扫描指定的文件系统，获取磁盘的使用情况，创建、检查和修复磁盘配额（quota）文件。执行quotacheck指令，扫描挂入系统的分区，并在各分区的文件系统根目录下产生quota.user和quota.group文件，设置用户和群组的磁盘空间限制。</p>
<p>语法 quotacheck(选项)(参数)</p>
<p>选项</p>
<ul>
<li>-a：扫描在/etc/fstab文件里，有加入quota设置的分区；</li>
<li>-d：详细显示指令执行过程，便于排错或了解程序执行的情形；</li>
<li>-g：扫描磁盘空间时，计算每个群组识别码所占用的目录和文件数目；</li>
<li>-R：排除根目录所在的分区；</li>
<li>-u：扫描磁盘空间时，计算每个用户识别码所占用的目录和文件数目；</li>
<li>-v：显示指令执行过程。</li>
</ul>
<p>参数 文件系统：指定要扫描的文件系统。</p>
<h4 id="quota" class="article-heading"><a href="#quota" class="headerlink" title="quota"></a>quota<a class="article-anchor" href="#quota" aria-hidden="true"></a></h4><p>quota命令用于显示用户或者工作组的磁盘配额信息。输出信息包括磁盘使用和配额限制。</p>
<p>语法 quota(选项)(参数)</p>
<p>选项</p>
<ul>
<li>-g：列出群组的磁盘空间限制；</li>
<li>-q：简明列表，只列出超过限制的部分；</li>
<li>-u：列出用户的磁盘空间限制；</li>
<li>-v：显示该用户或群组，在所有挂入系统的存储设备的空间限制；</li>
<li>-V：显示版本信息。</li>
</ul>
<p>参数 用户或者工作组：指定要显示的用户或者工作组。</p>
<h4 id="quotaon" class="article-heading"><a href="#quotaon" class="headerlink" title="quotaon"></a>quotaon<a class="article-anchor" href="#quotaon" aria-hidden="true"></a></h4><p>quotaon命令用于激活Linux内核中指定文件系统的磁盘配额功能。</p>
<p>语法 quotaon(选项)(参数)</p>
<p>选项</p>
<ul>
<li>-a：开启在/ect/fstab文件里，有加入quota设置的分区的空间限制；</li>
<li>-g：开启群组的磁盘空间限制；</li>
<li>-u：开启用户的磁盘空间限制；</li>
<li>-v：显示指令指令执行过程。</li>
</ul>
<p>参数 文件系统：指定要激活磁盘配额功能的文件系统。</p>
<h4 id="repquota" class="article-heading"><a href="#repquota" class="headerlink" title="repquota"></a>repquota<a class="article-anchor" href="#repquota" aria-hidden="true"></a></h4><p>repquota命令以报表的格式输出指定分区，或者文件系统的磁盘配额信息。</p>
<p>语法 repquota(选项)(参数)</p>
<p>选项</p>
<ul>
<li>-a：列出在/etc/fstab文件里，有加入quota设置的分区的使用状况，包括用户和群组；</li>
<li>-g：列出所有群组的磁盘空间限制；</li>
<li>-u：列出所有用户的磁盘空间限制；</li>
<li>-v：显示该用户或群组的所有空间限制。</li>
</ul>
<p>参数 文件系统：要打印报表的文件系统或者对应的设备文件名。</p>
<h4 id="edquota" class="article-heading"><a href="#edquota" class="headerlink" title="edquota"></a>edquota<a class="article-anchor" href="#edquota" aria-hidden="true"></a></h4><p>edquota 命令用于超级用户编辑其他用户的 quota 配额限制</p>
<p>格式为: “ edquota [参数] [用户]”。</p>
<p>参数 作用</p>
<ul>
<li>-u 编辑用户的配额限制。</li>
<li>-g 编辑用户组的配额限制。</li>
<li>-r 通过 RPC 协议编辑远程的配额。</li>
</ul>
<h4 id="xfs-quota" class="article-heading"><a href="#xfs-quota" class="headerlink" title="xfs_quota"></a>xfs_quota<a class="article-anchor" href="#xfs-quota" aria-hidden="true"></a></h4><p>xfs_quota 命令用于管理 XFS 文件系统的 quota 硬盘配额</p>
<p>格式为: “ quota [参数] 配额 文件系统 ” 。</p>
<p>参数 作用</p>
<ul>
<li>-c 命令 以交换式或参数的形式设置要执行的命令。</li>
<li>-p 设置提示或报错信息的程序名称,默认为 xfs_quota。</li>
<li>-x 专家模式,能够对 quota 做更多复杂的配置。</li>
</ul>
<h3 id="实验" class="article-heading"><a href="#实验" class="headerlink" title="实验"></a>实验<a class="article-anchor" href="#实验" aria-hidden="true"></a></h3><h4 id="rhel6-quota实验" class="article-heading"><a href="#rhel6-quota实验" class="headerlink" title="rhel6 quota实验"></a>rhel6 quota实验<a class="article-anchor" href="#rhel6-quota实验" aria-hidden="true"></a></h4><p>划分分区/dev/vdb2，格式化成ext4文件系统，并挂载在student家目录下使用，限制磁盘软限制为 3M、磁盘硬限制为 6M、文件软限制为 20 个且文件硬限制为 30 个</p>
<ol>
<li>挂载时需要加上 -o usrquota,grpquota 选项 ：mount -o usrquota,grpquota /dev/vdb2 /home/student</li>
<li>/etc/skel 需要的文件需要复制到家目录下 ：cp .bash* .gnome2 .mozilla -r /home/student</li>
<li>修改家目录权限 ：chown student.student /home/student ;setenforce 0</li>
<li>检测:quotacheck -cugm /home/student/ 检测结果 : aquota.group aquota.user &lt;== 只有 root 用户有读写权限</li>
<li>激活 :quotaon /home/student</li>
<li>打印磁盘配额的报告 :repquota /home/student</li>
<li>编辑edquota student</li>
</ol>
<figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line">[root@rhel6 ~]# mount -o usrquota,grpquota /dev/vdb2 /home/student</span><br><span class="line">[root@rhel6 ~]# ll /home/student</span><br><span class="line">total 16</span><br><span class="line">drwx------. 2 root root 16384 Jul  1 15:56 lost+found</span><br><span class="line">[root@rhel6 ~]# cd /etc/skel</span><br><span class="line">[root@rhel6 skel]# cp .bash* .gnome* .moz* -r /home/student</span><br><span class="line">[root@rhel6 skel]# ll /home/student -a</span><br><span class="line">total 42</span><br><span class="line">drwxr-xr-x. 5 root root  4096 Jul  1 16:00 .</span><br><span class="line">drwxr-xr-x. 4 root root  1024 Jul  2  2015 ..</span><br><span class="line">-rw-r--r--. 1 root root    18 Jul  1 16:00 .bash_logout</span><br><span class="line">-rw-r--r--. 1 root root   176 Jul  1 16:00 .bash_profile</span><br><span class="line">-rw-r--r--. 1 root root   124 Jul  1 16:00 .bashrc</span><br><span class="line">drwxr-xr-x. 2 root root  4096 Jul  1 16:00 .gnome2</span><br><span class="line">drwx------. 2 root root 16384 Jul  1 15:56 lost+found</span><br><span class="line">drwxr-xr-x. 4 root root  4096 Jul  1 16:00 .mozilla</span><br><span class="line">[root@rhel6 skel]# chown student. /home/student -R</span><br><span class="line">[root@rhel6 skel]# setenforce 0</span><br><span class="line">[root@rhel6 skel]# quotacheck -cugm /home/student</span><br><span class="line">[root@rhel6 skel]# ll /home/student</span><br><span class="line">total 32</span><br><span class="line">-rw-------. 1 root    root     6144 Jul  1 16:03 aquota.group</span><br><span class="line">-rw-------. 1 root    root     6144 Jul  1 16:03 aquota.user</span><br><span class="line">drwx------. 2 student student 16384 Jul  1 15:56 lost+found</span><br><span class="line">[root@rhel6 skel]# quotaon /home/student</span><br><span class="line">[root@rhel6 skel]# repquota /home/student</span><br><span class="line">*** Report for user quotas on device /dev/vdb2</span><br><span class="line">Block grace time: 7days; Inode grace time: 7days</span><br><span class="line">                        Block limits                File limits</span><br><span class="line">User            used    soft    hard  grace    used  soft  hard  grace</span><br><span class="line">----------------------------------------------------------------------</span><br><span class="line">student   --      48       0       0              9     0     0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@rhel6 skel]# edquota student</span><br><span class="line">edquota: WARNING - /dev/vdb2: cannot change current inode allocation</span><br><span class="line">[root@rhel6 skel]# edquota student</span><br><span class="line">[root@rhel6 skel]# repquota /home/student</span><br><span class="line">*** Report for user quotas on device /dev/vdb2</span><br><span class="line">Block grace time: 7days; Inode grace time: 7days</span><br><span class="line">                        Block limits                File limits</span><br><span class="line">User            used    soft    hard  grace    used  soft  hard  grace</span><br><span class="line">----------------------------------------------------------------------</span><br><span class="line">student   -+      48    3072    6144              9     3     6  7days</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@rhel6 skel]# quota student</span><br><span class="line">Disk quotas for user student (uid 500):</span><br><span class="line">     Filesystem  blocks   quota   limit   grace   files   quota   limit   grace</span><br><span class="line">      /dev/vdb2      48    3072    6144               9*      3       6   7days</span><br><span class="line">[root@rhel6 skel]# su - student</span><br><span class="line">[student@rhel6 ~]$ touch file{1..10}</span><br><span class="line">vdb2: write failed, user file limit reached.</span><br><span class="line">touch: cannot touch `file1': Disk quota exceeded</span><br><span class="line">touch: cannot touch `file2': Disk quota exceeded</span><br><span class="line">touch: cannot touch `file3': Disk quota exceeded</span><br><span class="line">touch: cannot touch `file4': Disk quota exceeded</span><br><span class="line">touch: cannot touch `file5': Disk quota exceeded</span><br><span class="line">touch: cannot touch `file6': Disk quota exceeded</span><br><span class="line">touch: cannot touch `file7': Disk quota exceeded</span><br><span class="line">touch: cannot touch `file8': Disk quota exceeded</span><br><span class="line">touch: cannot touch `file9': Disk quota exceeded</span><br><span class="line">touch: cannot touch `file10': Disk quota exceeded</span><br></pre></td></tr></tbody></table></figure>

<h4 id="rhel7-quota实验" class="article-heading"><a href="#rhel7-quota实验" class="headerlink" title="rhel7 quota实验"></a>rhel7 quota实验<a class="article-anchor" href="#rhel7-quota实验" aria-hidden="true"></a></h4><p>root用户：</p>
<ol>
<li>查看内核是否支持 quota 功能: dmesg | grep quota</li>
<li>查看 quota 程序包是否已经安装: rpm -q quota</li>
<li>查看 boot 目录是否支持 quota 功能(noquota 表示暂时不支持): mount|grep boot</li>
<li>让/boot 目录支持 quota 功能: vim /etc/fstab 属性中添加usrquota</li>
<li>重启主机后即可生效: reboot</li>
<li>查看 boot 目录是否支持 quota 功能(usrquota 表示已经支持): mount|grep boot</li>
<li>创建一个用于 quota 实验的用户 tom: useradd tom &amp;&amp; echo uplooking|passwd tom</li>
<li>需要允许其他用户对/boot 目录写入文件操作: chmod -Rf o+w /boot</li>
<li>使用 xfs_quota 命令设置对 tom 用户在/boot 目录的磁盘配额,具体要求如下:<br>使用 quota 专家模式限制磁盘软限制为 3m、磁盘硬限制为 6m、文件软限制为 3 个且文件硬限制为 6 个。 获取当前/boot 目录上的 quota 配额限制</li>
</ol>
<figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line">xfs_quota -x -c 'limit bsoft=3m bhard=6m isoft=3 ihard=6 tom' /boot</span><br><span class="line">xfs_quota -x -c report /boot</span><br></pre></td></tr></tbody></table></figure>

<p>切换至 tom 用户: su - tom</p>
<ol>
<li>正常创建了一个为 5M 的文件: dd if=/dev/zero of=/boot/tom bs=5M count=1</li>
<li>创建 8M 文件时强制终止并报错了: dd if=/dev/zero of=/boot/tom bs=8M count=1</li>
<li>查看当前用户的 quota 限制(显示硬盘配额已占满): quota</li>
</ol>
<p>切换至root用户：exit</p>
<ol>
<li>编辑 tom 的配额限制,将硬盘的硬限制修改为 8m(8192k): edquota -u tom</li>
</ol>
<p>切换至 tom 用户: su - tom</p>
<ol>
<li>再来创建 8m 的文件就不会有问题了: dd if=/dev/zero of=/boot/tom bs=8M count=1</li>
</ol>
<figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line">[root@rhel7 ~]# dmesg|grep quota</span><br><span class="line">[    0.836809] VFS: Disk quotas dquot_6.5.2</span><br><span class="line">[root@rhel7 ~]# rpm -q quota</span><br><span class="line">quota-4.01-11.el7.x86_64</span><br><span class="line">[root@rhel7 ~]# mount|grep boot</span><br><span class="line">/dev/vda1 on /boot type xfs (rw,relatime,seclabel,attr2,inode64,noquota)</span><br><span class="line">[root@rhel7 ~]# vim /etc/fstab</span><br><span class="line">UUID=abbadca9-0a0d-453f-b713-d3d978cd6909 /boot                   xfs     defaults,usrquota        1 2</span><br><span class="line">[root@rhel7 ~]# reboot</span><br><span class="line">[root@rhel7 ~]# mount|grep boot</span><br><span class="line">/dev/vda1 on /boot type xfs (rw,relatime,seclabel,attr2,inode64,usrquota)</span><br><span class="line">[root@rhel7 ~]# useradd tom</span><br><span class="line">[root@rhel7 ~]# passwd tom</span><br><span class="line">Changing password for user tom.</span><br><span class="line">New password:</span><br><span class="line">BAD PASSWORD: The password fails the dictionary check - it is based on a dictionary word</span><br><span class="line">Retype new password:</span><br><span class="line">passwd: all authentication tokens updated successfully.</span><br><span class="line">[root@rhel7 ~]# chmod -Rf o+w /boot</span><br><span class="line">[root@rhel7 ~]# ll -d /boot</span><br><span class="line">dr-xr-xrwx. 3 root root 4096 Jun 27 03:59 /boot</span><br><span class="line">[root@rhel7 ~]# xfs_quota -x -c 'limit bsoft=3m bhard=6m isoft=3 ihard=6 tom' /boot</span><br><span class="line">[root@rhel7 ~]# xfs_quota -x -c report /boot</span><br><span class="line">User quota on /boot (/dev/vda1)</span><br><span class="line">                               Blocks</span><br><span class="line">User ID          Used       Soft       Hard    Warn/Grace</span><br><span class="line">---------- --------------------------------------------------</span><br><span class="line">root           120384          0          0     00 [--------]</span><br><span class="line">tom                 0       3072       6144     00 [--------]</span><br><span class="line"></span><br><span class="line">[root@rhel7 ~]# su - tom</span><br><span class="line">Last login: Fri Jul  1 02:51:33 EDT 2016 on pts/0</span><br><span class="line">[tom@rhel7 ~]$ dd if=/dev/zero of=/boot/tom bs=5M count=1</span><br><span class="line">1+0 records in</span><br><span class="line">1+0 records out</span><br><span class="line">5242880 bytes (5.2 MB) copied, 0.0270144 s, 194 MB/s</span><br><span class="line">[tom@rhel7 ~]$ dd if=/dev/zero of=/boot/tom bs=8M count=1</span><br><span class="line">dd: error writing ‘/boot/tom’: Disk quota exceeded</span><br><span class="line">1+0 records in</span><br><span class="line">0+0 records out</span><br><span class="line">6291456 bytes (6.3 MB) copied, 0.218067 s, 28.9 MB/s</span><br><span class="line">[tom@rhel7 ~]$ quota</span><br><span class="line">Disk quotas for user tom (uid 1001):</span><br><span class="line">     Filesystem  blocks   quota   limit   grace   files   quota   limit   grace</span><br><span class="line">      /dev/vda1    6144*   3072    6144   6days       1       3       6</span><br><span class="line">[tom@rhel7 ~]$ exit</span><br><span class="line">logout</span><br><span class="line">[root@rhel7 ~]# edquota -u tom</span><br><span class="line">Disk quotas for user tom (uid 1001):</span><br><span class="line">  Filesystem                   blocks       soft       hard     inodes     soft     hard</span><br><span class="line">  /dev/vda1                      8192       3072       8192          1        3        6</span><br><span class="line">[root@rhel7 ~]# xfs_quota -x -c report /boot</span><br><span class="line">User quota on /boot (/dev/vda1)</span><br><span class="line">                               Blocks</span><br><span class="line">User ID          Used       Soft       Hard    Warn/Grace</span><br><span class="line">---------- --------------------------------------------------</span><br><span class="line">root           120384          0          0     00 [--------]</span><br><span class="line">tom              6144       3072       8192     00  [6 days]</span><br><span class="line"></span><br><span class="line">[root@rhel7 ~]# su - tom</span><br><span class="line">Last login: Fri Jul  1 02:58:22 EDT 2016 on pts/0</span><br><span class="line">[tom@rhel7 ~]$ dd if=/dev/zero of=/boot/tom bs=8M count=1</span><br><span class="line">1+0 records in</span><br><span class="line">1+0 records out</span><br><span class="line">8388608 bytes (8.4 MB) copied, 0.267325 s, 31.4 MB/s</span><br><span class="line">[tom@rhel7 ~]$ exit</span><br><span class="line">logout</span><br></pre></td></tr></tbody></table></figure>

<h2 id="逻辑卷管理-LVM" class="article-heading"><a href="#逻辑卷管理-LVM" class="headerlink" title="逻辑卷管理 LVM"></a>逻辑卷管理 LVM<a class="article-anchor" href="#逻辑卷管理-LVM" aria-hidden="true"></a></h2><p>逻辑卷管理 (Logical Volume Manager)</p>
<h3 id="作用" class="article-heading"><a href="#作用" class="headerlink" title="作用"></a>作用<a class="article-anchor" href="#作用" aria-hidden="true"></a></h3><p>当用户根据实际情况需要对分区增加、减小等调整时,经常会受到硬盘 “ 灵活性 ” 的限制,很不方便。</p>
<p>逻辑卷管理器则是在磁盘分区与文件系统之间添加的逻辑层,提供一个抽象的卷组,使得管理者可以忽略底层磁盘布局, 从而实现对分区的灵活动态调整,这毫不夸张,所以红帽 RHEL7 系统已经默认启用了 LVM(Logical Volume Manager) 机制。</p>
<h3 id="原理" class="article-heading"><a href="#原理" class="headerlink" title="原理"></a>原理<a class="article-anchor" href="#原理" aria-hidden="true"></a></h3><p><img src="pic/00.png" alt="00"></p>
<p>将物理分区做成 pv ；将 pv 组合成 vg ；再从 vg 分出 lv 分区 –&gt;pv–&gt;vg–&gt;lv</p>
<ul>
<li>物理卷(PV,Physical Volume ): 整个硬盘设备或使用 fdisk 命令建立的硬盘分区。</li>
<li>卷组(VG,Volume Group ) :由一个或多个物理卷(PV)组成的整体</li>
<li>逻辑卷(LV,Logical Volume ):从卷组(VG)出切割出的空间来用于创建文件系统,大小由 PE 的个数决定。</li>
</ul>
<h3 id="步骤" class="article-heading"><a href="#步骤" class="headerlink" title="步骤"></a>步骤<a class="article-anchor" href="#步骤" aria-hidden="true"></a></h3><p><img src="pic/27.png" alt="27"><br><img src="pic/28.png" alt="28"><br><img src="pic/30.png" alt="30"><br><img src="pic/31.png" alt="31"></p>
<h3 id="实验-1" class="article-heading"><a href="#实验-1" class="headerlink" title="实验"></a>实验<a class="article-anchor" href="#实验-1" aria-hidden="true"></a></h3><p>实验：linear 目前用户的映射目标为linear型，线性型，/dev/vdb1 pv1 100M;/dev/vdb2 pv2 100M;/dev/vdb3 pv 3 100M—–&gt;myvg 300M—–&gt;lv1-linear 20M;lv2-linear 60M现在lv1-linear不够用了，需要拓展60M的空间，lv2-linear也不够用了，需要拓展30M的空间，如何做才能提高读写速度？</p>
<p><img src="pic/32.png" alt="32"></p>
<figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line">root@iscsi1-f15 ~]# dmsetup table|grep my</span><br><span class="line">myvg-lv1--linear: 0 40960 linear 252:21 2048</span><br><span class="line">myvg-lv1--linear: 40960 32768 linear 252:21 165888</span><br><span class="line">myvg-lv1--linear: 73728 90112 linear 252:22 2048</span><br><span class="line">myvg-lv2--linear: 0 122880 linear 252:21 43008</span><br><span class="line">myvg-lv2--linear: 122880 65536 linear 252:22 92160</span><br><span class="line">–------------------------------------------------------------------------</span><br><span class="line">[root@iscsi1-f15 ~]# dmsetup table|grep myvg</span><br><span class="line">myvg-lv1--linear: 0 73728 linear 252:25 2048</span><br><span class="line">myvg-lv1--linear: 73728 90112 linear 252:25 75776</span><br><span class="line">myvg-lv2--linear: 0 122880 linear 252:25 165888</span><br><span class="line">myvg-lv2--linear: 122880 65536 linear 252:25 288768</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line">[root@iscsi1-f15 ~]# fdisk /dev/vdb ---&gt;vdb[123] 100M</span><br><span class="line">[root@iscsi1-f15 ~]# pvcreate /dev/vdb[123]</span><br><span class="line">[root@iscsi1-f15 ~]# vgcreate myvg /dev/vdb[123]</span><br><span class="line">[root@iscsi1-f15 ~]# lvcreate -L 20M myvg -n lv1-linear</span><br><span class="line">[root@iscsi1-f15 ~]# lvcreate -L 60M myvg -n lv2-linear</span><br><span class="line">[root@iscsi1-f15 ~]# mkfs.ext4 /dev/myvg/lv1-linear</span><br><span class="line">[root@iscsi1-f15 ~]# mkfs.ext4 /dev/myvg/lv2-linear</span><br><span class="line">[root@iscsi1-f15 ~]# mount /dev/myvg/lv1-linear /opt/lv1</span><br><span class="line">[root@iscsi1-f15 ~]# mount /dev/myvg/lv2-linear /opt/lv2</span><br><span class="line">[root@iscsi1-f15 ~]# lvextend -L +60M /dev/myvg/lv1-linear</span><br><span class="line">[root@iscsi1-f15 ~]# lvextend -L +30M /dev/myvg/lv2-linear</span><br><span class="line">[root@iscsi1-f15 ~]# resize2fs /dev/myvg/lv1-linear</span><br><span class="line">[root@iscsi1-f15 ~]# resize2fs /dev/myvg/lv2-linear</span><br><span class="line">[root@iscsi1-f15 ~]# dmsetup table|grep my</span><br><span class="line">myvg-lv1--linear: 0 40960 linear 252:21 2048</span><br><span class="line">myvg-lv1--linear: 40960 32768 linear 252:21 165888</span><br><span class="line">myvg-lv1--linear: 73728 90112 linear 252:22 2048</span><br><span class="line">myvg-lv2--linear: 0 122880 linear 252:21 43008</span><br><span class="line">myvg-lv2--linear: 122880 65536 linear 252:22 92160</span><br><span class="line">–------------------------------------------------------------------------</span><br><span class="line">[root@iscsi1-f15 ~]# fdisk /dev/vdb ---&gt;vdb4 500M vdb5 500M</span><br><span class="line">[root@iscsi1-f15 ~]# partx -a /dev/vdb</span><br><span class="line">[root@iscsi1-f15 ~]# pvcreate /dev/vdb[45]</span><br><span class="line">[root@iscsi1-f15 ~]# vgextend myvg /dev/vdb[45]</span><br><span class="line">[root@iscsi1-f15 ~]# pvmove /dev/vdb1 /dev/vdb4</span><br><span class="line">[root@iscsi1-f15 ~]# pvmove /dev/vdb2 /dev/vdb4</span><br><span class="line">[root@iscsi1-f15 ~]# pvmove /dev/vdb4 /dev/vdb5</span><br><span class="line">[root@iscsi1-f15 ~]# dmsetup table|grep myvg</span><br><span class="line">myvg-lv1--linear: 0 73728 linear 252:25 2048</span><br><span class="line">myvg-lv1--linear: 73728 90112 linear 252:25 75776</span><br><span class="line">myvg-lv2--linear: 0 122880 linear 252:25 165888</span><br><span class="line">myvg-lv2--linear: 122880 65536 linear 252:25 288768</span><br></pre></td></tr></tbody></table></figure>

<h2 id="Linux文件系统和磁盘管理作业" class="article-heading"><a href="#Linux文件系统和磁盘管理作业" class="headerlink" title="Linux文件系统和磁盘管理作业"></a>Linux文件系统和磁盘管理作业<a class="article-anchor" href="#Linux文件系统和磁盘管理作业" aria-hidden="true"></a></h2><ol>
<li>分别在rhel6和rhel7上划分/dev/vdb磁盘，要求，/dev/vdb1大小为1G，/dev/vdb2大小为2G；创建对应操作系统默认的文件系统，rhel6默认ext4，rhel7默认xfs。</li>
<li>rhel6上将/dev/vdb2挂载在student家目录下使用，限制磁盘软限制为 3M、磁盘硬限制为 6M、文件软限制为 20 个且文件硬限制为 30 个</li>
<li>rhel7上完成：<br>root用户：</li>
</ol>
<figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line"> 1. 查看内核是否支持 quota 功能:</span><br><span class="line"> 2. 查看 quota 程序包是否已经安装:</span><br><span class="line"> 3. 查看 boot 目录是否支持 quota 功能(noquota 表示暂时不支持):</span><br><span class="line"> 4. 让/boot 目录支持 quota 功能:</span><br><span class="line"> 5. 重启主机后即可生效:</span><br><span class="line"> 6. 查看 boot 目录是否支持 quota 功能(usrquota 表示已经支持):</span><br><span class="line"> 7. 创建一个用于 quota 实验的用户 tom:</span><br><span class="line"> 8. 需要允许其他用户对/boot 目录写入文件操作:</span><br><span class="line"> 9. 使用 xfs_quota 命令设置对 tom 用户在/boot 目录的磁盘配额,具体要求如下:</span><br><span class="line">使用 quota 专家模式限制磁盘软限制为 3m、磁盘硬限制为 6m、文件软限制为 3 个且文件硬限制为 6 个。 获取当前/boot 目录上的 quota 配额限制</span><br></pre></td></tr></tbody></table></figure>

<p>切换至 tom 用户:</p>
<ol>
<li>正常创建了一个为 5M 的文件:</li>
<li>创建 8M 文件时强制终止并报错了:</li>
<li>查看当前用户的 quota 限制(显示硬盘配额已占满):</li>
</ol>
<p>切换至root用户：</p>
<ol>
<li>编辑 tom 的配额限制,将硬盘的硬限制修改为 8m(8192k):</li>
</ol>
<p>切换至 tom 用户:</p>
<ol>
<li>再来创建 8m 的文件就不会有问题了:</li>
</ol>
<hr>
<ol start="4">
<li>rhel6和rhel7上完成lvm逻辑卷管理，要求：</li>
</ol>
<figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line">1）/dev/vdb1 100M;/dev/vdb2 100M;/dev/vdb3 100M;/dev/vdb4 100M</span><br><span class="line">2) 将/dev/vdb[1,2,3,4]做成pv</span><br><span class="line">3）/dev/vdb1,/dev/vdb2组成vgtest300M</span><br><span class="line">4）从vgtest中划分50M的lvtest1</span><br><span class="line">5）将lvtest1挂载到/mnt下使用</span><br><span class="line">6）拓展lvtest1至200M</span><br><span class="line">7）拓展lvtest1至400M</span><br><span class="line">8）缩小lvtest1至50M</span><br></pre></td></tr></tbody></table></figure>
</body></html>
              </div>
              <footer class="article-footer">
                <time class="article-footer-updated" datetime="2025-10-22T08:48:51.544Z" itemprop="dateModified">Last updated: 2025-10-22</time>
                <a href="/linux/0_linux_base/index.html" class="article-footer-next" title="概览"><span>Next</span><i class="fa fa-chevron-right"></i></a>
              </footer>
              
            </div>
          </div>
          <aside id="article-toc" role="navigation">
            <div id="article-toc-inner">
              <div id="carbonads" class="carbonads" style="text-align:center;font-family:'Noto Sans SC',sans-serif;">
  <span class="carbon-wrap">
    <a href="https://github.com/booboowei"
       class="carbon-img"
       target="_blank"
       rel="noopener sponsored">
      <img
        src="https://avatars2.githubusercontent.com/u/21328020?s=460&u=88cf6127c32932188f936d05636b7b0d36783ee1&v=4"
        alt="ads via Carbon"
        border="0"
        style="width:80px;height:80px;border-radius:50%;max-width:130px;"
      />
    </a>
    <a href="/about/"
       class="carbon-text"
       target="_blank"
       rel="noopener sponsored"
       style="display:block;margin-top:4px;">
      欢迎光临
    </a>
  </span>

  <!-- 日期显示 -->
  <div id="today-date" style="margin-top:12px;background:#f5f5f5;border-radius:12px;padding:10px 0;">
    <div id="weekday" style="font-size:14px;color:#555;"></div>
    <div id="day" style="font-size:36px;font-weight:bold;color:#000;"></div>
    <div id="ym" style="font-size:14px;color:#555;"></div>
    <div id="lunar" style="font-size:13px;color:#888;margin-top:4px;"></div>
  </div>

<script>
(function(){
  const now = new Date();
  const weekdays = ["星期日","星期一","星期二","星期三","星期四","星期五","星期六"];
  const year = now.getFullYear();
  const month = now.getMonth() + 1;
  const day = now.getDate();

  function toChineseNumber(num) {
    const map = {0:'〇',1:'一',2:'二',3:'三',4:'四',5:'五',6:'六',7:'七',8:'八',9:'九'};
    return String(num).split('').map(n=>map[n]).join('');
  }

  // 优先使用 Intl (现代浏览器支持农历/中国传统历)
  function getLunarByIntl(date) {
    try {
      // 获取农历的月（长格式，如 "九月" 或 "闰八月"），和日（数字）
      const monthFormatter = new Intl.DateTimeFormat('zh-CN-u-ca-chinese', { month: 'long' });
      const dayFormatter = new Intl.DateTimeFormat('zh-CN-u-ca-chinese', { day: 'numeric' });
      const lunarMonthText = monthFormatter.format(date); // 例如 "九月" 或 "闰八月"
      const lunarDayText = dayFormatter.format(date);     // 例如 "三十" 或 "初一"
      // 有的浏览器返回的 month 会包含 "闰" 字样，也可能返回汉字月份，需要适配
      return `农历${lunarMonthText}${lunarDayText}`;
    } catch (e) {
      return null; // 表示不支持 Intl 农历
    }
  }

  // 回退：简易本地农历算法（仅作兼容，适用于1900-2049范围）
  const lunarInfo = [0x04bd8,0x04ae0,0x0a570,0x054d5,0x0d260,0x0d950,0x16554,0x056a0,0x09ad0,0x055d2,
                     0x04ae0,0x0a5b6,0x0a4d0,0x0d250,0x1d255,0x0b540,0x0d6a0,0x0ada2,0x095b0,0x14977,
                     0x04970,0x0a4b0,0x0b4b5,0x06a50,0x06d40,0x1ab54,0x02b60,0x09570,0x052f2,0x04970,
                     0x06566,0x0d4a0,0x0ea50,0x06e95,0x05ad0,0x02b60,0x186e3,0x092e0,0x1c8d7,0x0c950,
                     0x0d4a0,0x1d8a6,0x0b550,0x056a0,0x1a5b4,0x025d0,0x092d0,0x0d2b2,0x0a950,0x0b557,
                     0x06ca0,0x0b550,0x15355,0x04da0,0x0a5b0,0x14573,0x052b0,0x0a9a8,0x0e950,0x06aa0,
                     0x0aea6,0x0ab50,0x04b60,0x0aae4,0x0a570,0x05260,0x0f263,0x0d950,0x05b57,0x056a0,
                     0x096d0,0x04dd5,0x04ad0,0x0a4d0,0x0d4d4,0x0d250,0x0d558,0x0b540,0x0b5a0,0x195a6,
                     0x095b0,0x049b0,0x0a974,0x0a4b0,0x0b27a,0x06a50,0x06d40,0x0af46,0x0ab60,0x09570,
                     0x04af5,0x04970,0x064b0,0x074a3,0x0ea50,0x06b58,0x05ac0,0x0ab60,0x096d5,0x092e0];

  function lYearDays(y){let i,sum=348;for(i=0x8000;i>0x8;i>>=1)sum+=(lunarInfo[y-1900]&i)?1:0;return sum+leapDays(y);}
  function leapDays(y){if(leapMonth(y))return(lunarInfo[y-1900]&0x10000)?30:29;else return 0;}
  function leapMonth(y){return lunarInfo[y-1900]&0xf;}
  function monthDays(y,m){return(lunarInfo[y-1900]&(0x10000>>m))?30:29;}

  function LunarFallback(objDate){
    let i, leap=0, temp=0;
    const baseDate = new Date(1900,0,31);
    let offset = Math.floor((objDate - baseDate) / 86400000);
    let year = 1900;
    // 年循环
    for (i = 1900; i < 2050 && offset > 0; i++) {
      temp = lYearDays(i);
      offset -= temp;
      year = i;
    }
    if (offset < 0) { offset += temp; year--; }
    leap = leapMonth(year);
    let isLeap = false;
    let month = 1;
    // 月循环
    for (i = 1; i <= 12 && offset > 0; i++) {
      if (leap > 0 && i === (leap + 1) && !isLeap) {
        // 进入闰月
        temp = leapDays(year);
        isLeap = true;
        i--; // stay on same month number but mark leap
      } else {
        temp = monthDays(year, i);
      }
      offset -= temp;
      if (isLeap && i === leap) { isLeap = false; }
      if (!isLeap) month++; // 非闰月时才推进月份计数
    }
    if (offset === 0 && leap > 0 && month === leap + 1) {
      // 特殊：当正好落在闰月第一天
      // month 保持，isLeap = true
    }
    if (offset < 0) { offset += temp; month--; }
    const day = offset + 1;
    // 修正 month 边界
    if (month <= 0) month = 1;
    return { year, month, day, isLeap: !!isLeap };
  }

  function getLunarDateStringFallback(y,m,d){
    const cDay=["","初一","初二","初三","初四","初五","初六","初七","初八","初九","初十",
                "十一","十二","十三","十四","十五","十六","十七","十八","十九","二十",
                "廿一","廿二","廿三","廿四","廿五","廿六","廿七","廿八","廿九","三十"];
    const cMon=["","正月","二月","三月","四月","五月","六月","七月","八月","九月","十月","冬月","腊月"];
    const lunar = LunarFallback(new Date(y, m-1, d));
    return `农历${lunar.isLeap ? '闰' : ''}${cMon[lunar.month]}${cDay[lunar.day]}`;
  }

  // 先尝试 Intl 方法
  let lunarText = getLunarByIntl(now);
  if (!lunarText) {
    // 回退本地算法
    lunarText = getLunarDateStringFallback(year, month, day);
  }

  // 输出到页面（公历 + 农历）
  document.getElementById("weekday").textContent = weekdays[now.getDay()];
  document.getElementById("day").textContent = day;
  document.getElementById("ym").textContent = `${toChineseNumber(year)}年${toChineseNumber(month)}月`;
  document.getElementById("lunar").textContent = lunarText;
})();
</script>


              <strong class="sidebar-title">Contents</strong>
              <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="toc-text">文件系统</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B5%84%E6%BA%90%E8%99%9A%E6%8B%9F%E5%8C%96"><span class="toc-text">资源虚拟化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="toc-text">文件系统的概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="toc-text">文件系统的类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%BB%93%E6%9E%84"><span class="toc-text">文件系统的结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">文件系统的区别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C"><span class="toc-text">文件系统的简单操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#df"><span class="toc-text">df</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#du"><span class="toc-text">du</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A3%81%E7%9B%98%E7%9A%84%E5%88%86%E5%89%B2%E3%80%81%E6%A0%BC%E5%BC%8F%E5%8C%96%E4%B8%8E%E6%8C%82%E8%BD%BD"><span class="toc-text">磁盘的分割、格式化与挂载</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E5%89%B2-fdisk"><span class="toc-text">分割 fdisk</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A3%81%E7%9B%98%E6%A0%BC%E5%BC%8F%E5%8C%96-mkfs"><span class="toc-text">磁盘格式化 mkfs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%82%E8%BD%BD"><span class="toc-text">挂载</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#mount-%E7%9A%84%E7%94%A8%E6%B3%95"><span class="toc-text">mount 的用法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#mount-%E7%9A%84%E6%9F%A5%E7%9C%8B"><span class="toc-text">mount 的查看</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#umount"><span class="toc-text">umount</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#etc-fstab-%E5%B0%86%E6%B0%B8%E4%B9%85%E7%94%9F%E6%95%88"><span class="toc-text">&#x2F;etc&#x2F;fstab 将永久生效</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A3%81%E7%9B%98%E9%85%8D%E9%A2%9D-Quota"><span class="toc-text">磁盘配额 Quota</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%9C%E7%94%A8%E5%92%8C%E5%88%86%E7%B1%BB"><span class="toc-text">作用和分类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4"><span class="toc-text">相关命令</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#quotacheck"><span class="toc-text">quotacheck</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#quota"><span class="toc-text">quota</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#quotaon"><span class="toc-text">quotaon</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#repquota"><span class="toc-text">repquota</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#edquota"><span class="toc-text">edquota</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#xfs-quota"><span class="toc-text">xfs_quota</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C"><span class="toc-text">实验</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#rhel6-quota%E5%AE%9E%E9%AA%8C"><span class="toc-text">rhel6 quota实验</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#rhel7-quota%E5%AE%9E%E9%AA%8C"><span class="toc-text">rhel7 quota实验</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E5%8D%B7%E7%AE%A1%E7%90%86-LVM"><span class="toc-text">逻辑卷管理 LVM</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%9C%E7%94%A8"><span class="toc-text">作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-text">原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A4"><span class="toc-text">步骤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C-1"><span class="toc-text">实验</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Linux%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%92%8C%E7%A3%81%E7%9B%98%E7%AE%A1%E7%90%86%E4%BD%9C%E4%B8%9A"><span class="toc-text">Linux文件系统和磁盘管理作业</span></a></li></ol>
              <a href="#" id="article-toc-top">Back to Top</a>
            </div>
          </aside>
        </div>
      </article>
      <aside id="sidebar" role="navigation">
  <div class="inner">
    <strong class="sidebar-title">Linux 中级</strong><a href="/linux/0_linux_base/index.html" class="sidebar-link">概览</a><a href="/linux/0_linux_base/booboo_linux_base/index.html" class="sidebar-link">Linux 基础</a><a href="/linux/0_linux_base/booboo_easy_service/index.html" class="sidebar-link">Linux 简易服务</a><a href="/linux/0_linux_base/booboo_bash_shell_scripts/index.html" class="sidebar-link">Linux 脚本编程</a><a href="/linux/0_linux_base/booboo_middle_service/index.html" class="sidebar-link">Linux 进阶</a><strong class="sidebar-title">Linux 日常</strong><a href="/linux/1_linux_dayday/index.html" class="sidebar-link">概览</a><strong class="sidebar-title">Ex-Tools</strong><a href="/linux/2_excellent_tools/index.html" class="sidebar-link">概览</a><strong class="sidebar-title">LAMP</strong><a href="/linux/3_lamp/index.html" class="sidebar-link">概览</a><strong class="sidebar-title">Docker</strong><a href="/linux/4_docker/index.html" class="sidebar-link">概览</a><strong class="sidebar-title">TICK</strong><a href="/linux/5_tick/index.html" class="sidebar-link">概览</a><a href="/linux/5_tick/kapacitor/index.html" class="sidebar-link">Kapacitor</a><strong class="sidebar-title">Devops</strong><a href="/linux/6_devops/index.html" class="sidebar-link">概览</a><a href="/linux/6_devops/bootstrap/index.html" class="sidebar-link">Bootstrap</a><a href="/linux/6_devops/booboo_python/index.html" class="sidebar-link">Python 基础</a><a href="/linux/6_devops/00_python_base/index.html" class="sidebar-link">Python 进阶</a><a href="/linux/6_devops/01_python_net/index.html" class="sidebar-link">Python 网络开发</a><a href="/linux/6_devops/02_python_threads/index.html" class="sidebar-link">Python 并发编程</a><a href="/linux/6_devops/11_flask_admin/index.html" class="sidebar-link">Flask_admin</a><a href="/linux/6_devops/12_mini_project/index.html" class="sidebar-link">迷你小项目</a><strong class="sidebar-title">Git</strong><a href="/linux/7_git/index.html" class="sidebar-link">概览</a><a href="/linux/7_git/Chapter01/index.html" class="sidebar-link">Git 基础</a><a href="/linux/7_git/Chapter02/index.html" class="sidebar-link">Git 常见场景</a><a href="/linux/7_git/Chapter04/index.html" class="sidebar-link">Git 多人协作</a><a href="/linux/7_git/Chapter05/index.html" class="sidebar-link">Git 集成使用禁忌</a><a href="/linux/7_git/Chapter06/index.html" class="sidebar-link">GitHub 初识</a><a href="/linux/7_git/Chapter07/index.html" class="sidebar-link">GitHub 使用</a><a href="/linux/7_git/Chapter03/index.html" class="sidebar-link">Github 同步</a><a href="/linux/7_git/Chapter08/index.html" class="sidebar-link">GitLab 实践</a>
  </div>
</aside>
    </div>
  </div>
</div>

    <footer id="footer" class="wrapper">
  <div class="inner">
    <div id="footer-copyright">
      &copy; 2025 <a href="https://github.com/BoobooWei" target="_blank">魏亚萍</a><br>
      Documentation licensed under <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank">CC BY 4.0</a>.<br>
      备案号：沪ICP备2020026043号
    </div>
    <div id="footer-links">
      <a href="https://www.youtube.com/@amyreading2023" class="footer-link" target="_blank">
        <img src="https://upload.wikimedia.org/wikipedia/commons/b/b8/YouTube_Logo_2017.svg" 
            alt="YouTube"
            style="height:24px; margin-bottom:-6px;">
      </a>
      <a href="https://github.com/BoobooWei" class="footer-link" target="_blank"><i class="fa fa-github-alt"></i></a>
    </div>
  </div>
</footer>

  </div>
  <div id="mobile-nav-dimmer"></div>
  <nav id="mobile-nav">
  <div id="mobile-nav-inner">
    <ul id="mobile-nav-list">
      <a href="../../../docs/" class="mobile-nav-link">Hexo</a><a href="../../../news/" class="mobile-nav-link">News</a><a href="../../../api/" class="mobile-nav-link">MySQL8.0</a><a href="../../../database/" class="mobile-nav-link">Database</a><a href="../../../linux/" class="mobile-nav-link">Linux</a><a href="../../../cloud/" class="mobile-nav-link">Cloud</a><a href="../../../singapore/" class="mobile-nav-link">Singapore</a><a href="../../../amy/" class="mobile-nav-link">AMY</a><a href="../../../about/" class="mobile-nav-link">About</a>
      <li class="mobile-nav-item">
        <a href="https://github.com/BoobooWei" class="mobile-nav-link" rel="external" target="_blank">GitHub</a>
      </li>
    </ul>
    
      <strong class="mobile-nav-title">Linux 中级</strong><a href="/linux/0_linux_base/index.html" class="mobile-nav-link">概览</a><a href="/linux/0_linux_base/booboo_linux_base/index.html" class="mobile-nav-link">Linux 基础</a><a href="/linux/0_linux_base/booboo_easy_service/index.html" class="mobile-nav-link">Linux 简易服务</a><a href="/linux/0_linux_base/booboo_bash_shell_scripts/index.html" class="mobile-nav-link">Linux 脚本编程</a><a href="/linux/0_linux_base/booboo_middle_service/index.html" class="mobile-nav-link">Linux 进阶</a><strong class="mobile-nav-title">Linux 日常</strong><a href="/linux/1_linux_dayday/index.html" class="mobile-nav-link">概览</a><strong class="mobile-nav-title">Ex-Tools</strong><a href="/linux/2_excellent_tools/index.html" class="mobile-nav-link">概览</a><strong class="mobile-nav-title">LAMP</strong><a href="/linux/3_lamp/index.html" class="mobile-nav-link">概览</a><strong class="mobile-nav-title">Docker</strong><a href="/linux/4_docker/index.html" class="mobile-nav-link">概览</a><strong class="mobile-nav-title">TICK</strong><a href="/linux/5_tick/index.html" class="mobile-nav-link">概览</a><a href="/linux/5_tick/kapacitor/index.html" class="mobile-nav-link">Kapacitor</a><strong class="mobile-nav-title">Devops</strong><a href="/linux/6_devops/index.html" class="mobile-nav-link">概览</a><a href="/linux/6_devops/bootstrap/index.html" class="mobile-nav-link">Bootstrap</a><a href="/linux/6_devops/booboo_python/index.html" class="mobile-nav-link">Python 基础</a><a href="/linux/6_devops/00_python_base/index.html" class="mobile-nav-link">Python 进阶</a><a href="/linux/6_devops/01_python_net/index.html" class="mobile-nav-link">Python 网络开发</a><a href="/linux/6_devops/02_python_threads/index.html" class="mobile-nav-link">Python 并发编程</a><a href="/linux/6_devops/11_flask_admin/index.html" class="mobile-nav-link">Flask_admin</a><a href="/linux/6_devops/12_mini_project/index.html" class="mobile-nav-link">迷你小项目</a><strong class="mobile-nav-title">Git</strong><a href="/linux/7_git/index.html" class="mobile-nav-link">概览</a><a href="/linux/7_git/Chapter01/index.html" class="mobile-nav-link">Git 基础</a><a href="/linux/7_git/Chapter02/index.html" class="mobile-nav-link">Git 常见场景</a><a href="/linux/7_git/Chapter04/index.html" class="mobile-nav-link">Git 多人协作</a><a href="/linux/7_git/Chapter05/index.html" class="mobile-nav-link">Git 集成使用禁忌</a><a href="/linux/7_git/Chapter06/index.html" class="mobile-nav-link">GitHub 初识</a><a href="/linux/7_git/Chapter07/index.html" class="mobile-nav-link">GitHub 使用</a><a href="/linux/7_git/Chapter03/index.html" class="mobile-nav-link">Github 同步</a><a href="/linux/7_git/Chapter08/index.html" class="mobile-nav-link">GitLab 实践</a>
    
  </div>
  <div id="mobile-lang-select-wrap">
    <span id="mobile-lang-select-label"><i class="fa fa-globe"></i><span>English</span></span>
    <select id="mobile-lang-select" data-canonical="">
      
        <option value="en" selected>English</option>
      
    </select>
  </div>
</nav>
  <!-- Scripts -->
<!-- Cookie -->
<script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>
<!-- build:js build/js/main.js -->

<script src="../../../js/lang_select.js"></script>


<script src="../../../js/mobile_nav.js"></script>

<!-- endbuild -->

<!-- Algolia -->
<!--   backup
<script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
<script type="text/javascript">
docsearch({
  appId: '',
  apiKey: '',
  indexName: '',
  insights: true,
  container: '#docsearch',
  debug: false,
  searchParameters: {
    facetFilters: ['lang:en']
  }
});
</script>
-->

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script type="text/javascript">
document.getElementById('search-input-wrap').classList.add('on');
docsearch({
    apiKey: '',
    indexName: '',
    inputSelector: '#search-input'
});
</script>
</body>
</html>